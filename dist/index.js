function e(e,t,i,s){Object.defineProperty(e,t,{get:i,set:s,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}function i(e){return e.location.position}function s(e){return e.location.file}function n(e){var t;return atom.project.relativizePath(null!==(t=s(e))&&void 0!==t?t:"")[1]}function o(){let e=atom.workspace.getCenter().getActivePaneItem();const t=null!==e&&atom.workspace.isTextEditor(e);return!t&&e&&We&&e.getURI&&"atom://linter-ui-default"===e.getURI()&&(!We.isAlive||We.isAlive())?e=We:We=e,t?e:null}function r(e,t,i=null){const n=[];return e.forEach((e=>{e&&e.location&&(t&&s(e)!==t||i&&e.severity!==i||n.push(e))})),n}function a(e,t,n){const o=[],r="Point"===n.constructor.name?new Be(n,n):Be.fromObject(n);return e.forEach((e=>{const n=s(e),a=i(e);"string"==typeof n&&a&&n===t&&"function"==typeof a.intersectsWith&&a.intersectsWith(r)&&o.push(e)})),o}async function l(e,t){const i={searchAllPanes:!0};t&&(i.initialLine=t.row,i.initialColumn=t.column),await atom.workspace.open(e,i)}async function u(e,t=!1){let n,o;if(t){if(!e.reference||!e.reference.file)return void console.warn("[Linter-UI-Default] Message does not have a valid reference. Ignoring");n=e.reference.file,o=e.reference.position}else{const t=i(e);n=s(e),t&&(o=t.start)}"string"==typeof n&&await l(n,o)}function c(e){2===e.version&&void 0!==e.url&&De.openExternal(e.url)}function d(e,t){const s=t[0],o="asc"===t[1]?1:-1;return e.sort(((e,t)=>{if("severity"===s){const i=Ge[e.severity],s=Ge[t.severity];if(i!==s)return o*(i>s?1:-1)}if("linterName"===s){const i=e.severity.localeCompare(t.severity);if(0!==i)return o*i}if("file"===s){const i=n(e),s=i.length,r=n(t),a=r.length;if(s!==a)return o*(s>a?1:-1);if(i!==r)return o*i.localeCompare(r)}if("line"===s){const s=i(e),n=i(t);if(s&&!n)return 1;if(n&&!s)return-1;if(s&&n){if(s.start.row!==n.start.row)return o*(s.start.row>n.start.row?1:-1);if(s.start.column!==n.start.column)return o*(s.start.column>n.start.column?1:-1)}}return 0}))}function h(e){return e.sort(((e,t)=>void 0===e.priority||void 0===t.priority?0:t.priority-e.priority))}function f(e,t){if("apply"in t)return t.apply(),!0;const i=t.position,s=t.replaceWith;if("currentText"in t){const s=t.currentText,n=e.getTextInBufferRange(i);if(s!==n)return console.warn("[linter-ui-default] Not applying fix because text did not match the expected one","expected",s,"but got",n),!1}return e.setTextInBufferRange(i,s),!0}function p(e,t,i){const s=e.get(t);if(void 0!==s)return s;{const s=i();return null!==s&&e.set(t,s),s}}function m(e){Ke.context=e}function g(e,t){t&&(it=t);const i=st,s=it,n=0===e.length?Ze:{owned:null,cleanups:null,context:null,owner:s,attached:!!t};let o;it=n,st=null;try{N((()=>o=e((()=>R(n)))),!0)}finally{st=i,it=s}return o}function v(e,t=!0,i){const s={value:e,observers:null,observerSlots:null,pending:Xe,comparator:t?"function"==typeof t?t:Ye:void 0};return[C.bind(s),E.bind(s)]}function w(e,t){S(T(e,t,!1))}function y(e,t){Qe=A;const i=T(e,t,!1);i.user=!0,rt&&rt.push(i)}function b(e,t,i=!0){const s=T(e,t,!0);return s.pending=Xe,s.observers=null,s.observerSlots=null,s.state=0,s.comparator=i?"function"==typeof i?i:Ye:void 0,S(s),C.bind(s)}function k(e){if(nt)return e();const t=nt=[],i=e();return nt=null,N((()=>{for(let e=0;t.length>e;e+=1){const i=t[e];if(i.pending!==Xe){const e=i.pending;i.pending=Xe,E.call(i,e)}}}),!1),i}function P(e){let t,i=st;return st=null,t=e(),st=i,t}function x(e){y((()=>P(e)))}function C(){if(this.state&&this.sources){const e=ot;ot=null,1===this.state?S(this):B(this),ot=e}if(st){const e=this.observers?this.observers.length:0;st.sources?(st.sources.push(this),st.sourceSlots.push(e)):(st.sources=[this],st.sourceSlots=[e]),this.observers?(this.observers.push(st),this.observerSlots.push(st.sources.length-1)):(this.observers=[st],this.observerSlots=[st.sources.length-1])}return at&&at.running&&at.sources.has(this)?this.tValue:this.value}function E(e,t){if(this.comparator)if(at&&at.running&&at.sources.has(this)){if(this.comparator(this.tValue,e))return e}else if(this.comparator(this.value,e))return e;return nt?(this.pending===Xe&&nt.push(this),this.pending=e,e):(at?((at.running||!t&&at.sources.has(this))&&(at.sources.add(this),this.tValue=e),at.running||(this.value=e)):this.value=e,!this.observers||ot&&!this.observers.length||N((()=>{for(let e=0;this.observers.length>e;e+=1){const t=this.observers[e];at&&at.running&&at.disposed.has(t)||(t.observers&&2!==t.state&&D(t),t.state=1,t.pure?ot.push(t):rt.push(t))}if(ot.length>1e6)throw ot=[],Error("Potential Infinite Loop Detected.")}),!1),e)}function S(e){if(!e.fn)return;R(e);const t=it,i=st,s=lt;st=it=e,L(e,e.value,s),at&&!at.running&&at.sources.has(e)&&(at.running=!0,L(e,e.tValue,s),at.running=!1),st=i,it=t}function L(e,t,i){let s;try{s=e.fn(t)}catch(e){O(e)}e.updatedAt&&e.updatedAt>i||(e.observers&&e.observers.length?E.call(e,s,!0):at&&at.running&&e.pure?(at.sources.add(e),e.tValue=s):e.value=s,e.updatedAt=i)}function T(e,t,i){const s={fn:e,state:1,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:it,context:null,pure:i};return null===it||it!==Ze&&(at&&at.running&&it.pure?it.tOwned?it.tOwned.push(s):it.tOwned=[s]:it.owned?it.owned.push(s):it.owned=[s]),s}function M(e){let t,i=1===e.state&&e;if(e.suspense&&P(e.suspense.inFallback))return e.suspense.effects.push(e);const s=at&&at.running;for(;(e.fn||s&&e.attached)&&(e=e.owner);){if(s&&at.disposed.has(e))return;2===e.state?t=e:1===e.state&&(i=e,t=void 0)}if(t){const n=ot;if(ot=null,B(t),ot=n,!i||1!==i.state)return;if(s)for(e=i;(e.fn||e.attached)&&(e=e.owner);)if(at.disposed.has(e))return}i&&S(i)}function N(e,t){if(ot)return e();let i=!1;t||(ot=[]),rt?i=!0:rt=[],lt++;try{e()}catch(e){O(e)}finally{(e=>{if(ot&&(I(ot),ot=null),e)return;let t;if(at&&at.running){if(at.promises.size)return at.running=!1,at.effects.push.apply(at.effects,rt),rt=null,void tt(!0);const e=at.sources;t=at.cb,at=null,k((()=>{e.forEach((e=>{if(e.value=e.tValue,e.owned)for(let t=0,i=e.owned.length;i>t;t++)R(e.owned[t]);e.tOwned&&(e.owned=e.tOwned),delete e.tValue,delete e.tOwned})),tt(!1)}))}rt.length?k((()=>{Qe(rt),rt=null})):rt=null,t&&t.forEach((e=>e()))})(i)}}function I(e){for(let t=0;e.length>t;t++)M(e[t])}function A(e){let t,i=0;for(t=0;e.length>t;t++){const s=e[t];s.user?e[i++]=s:M(s)}const s=e.length;for(t=0;i>t;t++)M(e[t]);for(t=s;e.length>t;t++)M(e[t])}function B(e){e.state=0;for(let t=0;e.sources.length>t;t+=1){const i=e.sources[t];i.sources&&(1===i.state?M(i):2===i.state&&B(i))}}function D(e){for(let t=0;e.observers.length>t;t+=1){const i=e.observers[t];i.state||(i.state=2,i.observers&&D(i))}}function R(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),i=e.sourceSlots.pop(),s=t.observers;if(s&&s.length){const e=s.pop(),n=t.observerSlots.pop();s.length>i&&(e.sourceSlots[n]=i,s[i]=e,t.observerSlots[i]=n)}}if(at&&at.running&&e.pure){if(e.tOwned){for(t=0;e.tOwned.length>t;t++)R(e.tOwned[t]);delete e.tOwned}F(e,!0)}else if(e.owned){for(t=0;e.owned.length>t;t++)R(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;e.cleanups.length>t;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function F(e,t){if(t||(e.state=0,at.disposed.add(e)),e.owned)for(let t=0;e.owned.length>t;t++)F(e.owned[t])}function O(e){const t=Je&&j(it,Je);if(!t)throw e;t.forEach((t=>t(e)))}function j(e,t){return e&&(e.context&&e.context[t]||e.owner&&j(e.owner,t))}function $(e,t){if(Ke.context){const i=Ke.context;m({...Ke.context,id:`${Ke.context.id}${Ke.context.count++}.`,count:0});const s=P((()=>e(t)));return m(i),s}return P((()=>e(t)))}function H(e){return b(((e,t,i={})=>{let s=[],n=[],o=[],r=0,a=t.length>1?[]:null,l=it;return u=()=>{for(let e=0,t=o.length;t>e;e++)o[e]()},null===it||(null===it.cleanups?it.cleanups=[u]:it.cleanups.push(u)),()=>{function u(e){if(o[d]=e,a){const[e,i]=v(d);return a[d]=i,t(h[d],e)}return t(h[d])}let c,d,h=e()||[];return P((()=>{let e,t,f,p,m,v,w,y,b,k=h.length;if(0===k){if(0!==r){for(c=0;r>c;c++)o[c]();o=[],s=[],n=[],r=0,a&&(a=[])}i.fallback&&(s=[ut],n[0]=g((e=>(o[0]=e,i.fallback())),l),r=1)}else if(0===r){for(d=0;k>d;d++)s[d]=h[d],n[d]=g(u,l);r=k}else{for(f=Array(k),p=Array(k),a&&(m=Array(k)),v=0,w=Math.min(r,k);w>v&&s[v]===h[v];v++);for(w=r-1,y=k-1;w>=v&&y>=v&&s[w]===h[y];w--,y--)f[y]=n[w],p[y]=o[w],a&&(m[y]=a[w]);for(e=new Map,t=Array(y+1),d=y;d>=v;d--)b=h[d],c=e.get(b),t[d]=void 0===c?-1:c,e.set(b,d);for(c=v;w>=c;c++)b=s[c],d=e.get(b),void 0!==d&&-1!==d?(f[d]=n[c],p[d]=o[c],a&&(m[d]=a[c]),d=t[d],e.set(b,d)):o[c]();for(d=v;k>d;d++)d in f?(n[d]=f[d],o[d]=p[d],a&&(a[d]=m[d],a[d](d))):n[d]=g(u,l);r=n.length=k,s=h.slice(0)}return n}))};var u})((()=>e.each),e.children,"fallback"in e&&{fallback(){return e.fallback}}||void 0),void 0,!1)}function q(e){let t=!1;const i=b((()=>e.when),void 0,((e,i)=>t?e===i:!e==!i));return b((()=>{const s=i();if(s){const i=e.children;return(t="function"==typeof i&&i.length>0)?P((()=>i(s))):i}return e.fallback}))}function V(e,t,i){let s=i.length,n=t.length,o=s,r=0,a=0,l=t[n-1].nextSibling,u=null;for(;n>r||o>a;)if(n===r){const t=s>o?a?i[a-1].nextSibling:i[o-a]:l;for(;o>a;)e.insertBefore(i[a++],t)}else if(o===a)for(;n>r;)u&&u.has(t[r])||e.removeChild(t[r]),r++;else if(t[r]===i[a])r++,a++;else if(t[n-1]===i[o-1])n--,o--;else if(t[r]===i[o-1]&&i[a]===t[n-1]){const s=t[--n].nextSibling;e.insertBefore(i[a++],t[r++].nextSibling),e.insertBefore(i[--o],s),t[n]=i[o]}else{if(!u){u=new Map;let e=a;for(;o>e;)u.set(i[e],e++)}const s=u.get(t[r]);if(null!=s)if(s>a&&o>s){let l,c=r,d=1;for(;++c<n&&o>c&&null!=(l=u.get(t[c]))&&l===s+d;)d++;if(d>s-a){const n=t[r];for(;s>a;)e.insertBefore(i[a++],n)}else e.replaceChild(i[a++],t[r++])}else r++;else e.removeChild(t[r++])}}function W(e,t,i){let s;return g((n=>{s=n,K(t,e(),t.firstChild?null:void 0,i)})),()=>{s(),t.textContent=""}}function G(e,t,i){const s=document.createElement("template");if(s.innerHTML=e,t&&s.innerHTML.split("<").length-1!==t)throw`Template html does not match input:\n${s.innerHTML}\n\n${e}`;let n=s.content.firstChild;return i&&(n=n.firstChild),n}function _(e){const t=document[ct]||(document[ct]=new Set);for(let i=0,s=e.length;s>i;i++){const s=e[i];t.has(s)||(t.add(s),document.addEventListener(s,Y))}}function z(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i)}function U(e,t,i,s){s?Array.isArray(i)?(e["$$"+t]=i[0],e[`$$${t}Data`]=i[1]):e["$$"+t]=i:e.addEventListener(t,Array.isArray(i)?e=>i[0](i[1],e):i)}function K(e,t,i,s){if(void 0===i||s||(s=[]),"function"!=typeof t)return J(e,t,s,i);w((s=>J(e,t(),s,i)),s)}function Y(e){const t="$$"+e.type;let i=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==i&&Object.defineProperty(e,"target",{configurable:!0,value:i}),Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>i});null!==i;){const s=i[t];if(s){const n=i[t+"Data"];if(void 0!==n?s(n,e):s(e),e.cancelBubble)return}i=i.host&&i.host!==i&&i.host instanceof Node?i.host:i.parentNode}}function J(e,t,i,s,n){for(;"function"==typeof i;)i=i();if(t===i)return i;const o=typeof t,r=void 0!==s;if(e=r&&i[0]&&i[0].parentNode||e,"string"===o||"number"===o)if("number"===o&&(t=""+t),r){let n=i[0];n&&3===n.nodeType?n.data=t:n=document.createTextNode(t),i=Z(e,i,s,n)}else i=""!==i&&"string"==typeof i?e.firstChild.data=t:e.textContent=t;else if(null==t||"boolean"===o){if(Ke.context)return i;i=Z(e,i,s)}else{if("function"===o)return w((()=>{let n=t();for(;"function"==typeof n;)n=n();i=J(e,n,i,s)})),()=>i;if(Array.isArray(t)){const o=[];if(Q(o,t,n))return w((()=>i=J(e,o,i,s,!0))),()=>i;if(Ke.context&&i.length)return i;if(0===o.length){if(i=Z(e,i,s),r)return i}else Array.isArray(i)?0===i.length?X(e,o,s):V(e,i,o):null==i||""===i?X(e,o):V(e,r&&i||[e.firstChild],o);i=o}else if(t instanceof Node){if(Array.isArray(i)){if(r)return i=Z(e,i,s,t);Z(e,i,null,t)}else null!=i&&""!==i&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);i=t}else console.warn("Skipped inserting",t)}return i}function Q(e,t,i){let s=!1;for(let n=0,o=t.length;o>n;n++){let o,r=t[n];if(r instanceof Node)e.push(r);else if(null==r||!0===r||!1===r);else if(Array.isArray(r))s=Q(e,r)||s;else if("string"==(o=typeof r))e.push(document.createTextNode(r));else if("function"===o)if(i){for(;"function"==typeof r;)r=r();s=Q(e,Array.isArray(r)?r:[r])||s}else e.push(r),s=!0;else e.push(document.createTextNode(""+r))}return s}function X(e,t,i){for(let s=0,n=t.length;n>s;s++)e.insertBefore(t[s],i)}function Z(e,t,i,s){if(void 0===i)return e.textContent="";const n=s||document.createTextNode("");if(t.length){let s=!1;for(let o=t.length-1;o>=0;o--){const r=t[o];if(n!==r){const t=r.parentNode===e;s||o?t&&e.removeChild(r):t?e.replaceChild(n,r):e.insertBefore(n,i)}else s=!0}}else e.insertBefore(n,i);return[n]}function ee(e){function t(){const t=n();return void 0!==t?t:void 0!==e.defaultSortDirection?e.defaultSortDirection:[null,null]}function i(){const i=t();null===i[0]&&void 0!==e.defaultSortDirection?a(l(r(),e.defaultSortDirection)):null!==i[0]&&a(l(r(),i))}var s;const[n,o]=v(),[r,a]=v(e.rows,!1);S(T((()=>{a(e.rows)}),undefined,!0));const l=null!==(s=e.rowSorter)&&void 0!==s?s:oe,{headerRenderer:u=ie,bodyRenderer:c=se,getRowID:d=ne,accessors:h}=e;return void 0===e.columns&&(e.columns=((e,t=0)=>{const i=Object.keys(e[t]),s=i.length,n=Array(s);for(let e=0;s>e;e++)n[e]={id:i[e]};return n})(e.rows,e.representitiveRowNumber)),i(),(()=>{const s=dt.cloneNode(!0),n=s.firstChild,a=n.nextSibling;return K(n.firstChild,$(H,{get each(){return e.columns},children(e){const s=!1!==e.sortable;return(()=>{const n=ht.cloneNode(!0);var r;return U(n,"click",s?(r=e.id,e=>{o(((e,t,i)=>{let s;return s=i?[null,null]:e[0]===t?[e[0],"asc"===e[1]?"desc":"asc"]:[t,"asc"],s})(t(),r,e.shiftKey)),i()}):void 0,!0),n.className=s?"sortable":void 0,K(n,(()=>u(e)),null),K(n,(()=>s?((e,t)=>{let i;return i=null===e[0]||e[0]!==t?wt:"asc"===e[1]?vt:gt,(()=>{const e=mt.cloneNode(!0);return K(e,i),e})()})(t(),e.id):void 0),null),w((()=>z(n,"id",h?e.id+"":void 0))),n})()}})),K(a,$(H,{get each(){return r()},children(t){const i=h?d(t):void 0;return(()=>{const s=ft.cloneNode(!0);return z(s,"id",i),K(s,$(H,{get each(){return e.columns},children(e){return(()=>{const s=pt.cloneNode(!0);return U(s,"click",void 0!==e.onClick?i=>e.onClick(i,t):void 0,!0),K(s,(()=>c(t,e.id))),w((()=>z(s,"id",i?`${i}.${e.id}`:void 0))),s})()}})),s})()}})),w((t=>{var i;const n="solid-simple-table "+(null!==(i=e.className)&&void 0!==i?i:""),o=e.style;return n!==t._v$&&(s.className=t._v$=n),t._v$2=((e,t,i={})=>{const s=e.style;if("string"==typeof t)return s.cssText=t;let n,o;for(o in"string"==typeof i&&(i={}),i)null==t[o]&&s.removeProperty(o),delete i[o];for(o in t)n=t[o],n!==i[o]&&(s.setProperty(o,n),i[o]=n);return i})(s,o,t._v$2),t}),{_v$:void 0,_v$2:void 0}),s})()}function te(e){return"string"==typeof e?e:JSON.stringify(e)}function ie(e){var t;return null!==(t=e.label)&&void 0!==t?t:e.id}function se(e,t){return te("object"==typeof e?e[t]:e)}function ne(e){return te(e)}function oe(e,t){if(!e.length)return e;let i;const s=t[0];return i="object"==typeof e[0]?e.sort(((e,t)=>{const i=e[s],n=t[s];return i===n?0:n>i?-1:1})):e.sort(),"desc"===t[1]?i.reverse():i}function re(e){const[t,i]=v(e.delegate.filteredMessages,!1);x((()=>{e.delegate.onDidChangeMessages((e=>{i(e)}))}));const s=[{id:"severity",label:"Severity"},{id:"linterName",label:"Provider"},{id:"excerpt",label:"Description",onClick:le,sortable:!1},{id:"line",label:"Line",onClick:le}];return"Entire Project"===e.delegate.panelRepresents&&s.push({id:"file",label:"File",onClick:le}),(()=>{const e=yt.cloneNode(!0);return z(e,"tabindex",-1),e.style.setProperty("overflowY","scroll"),e.style.setProperty("height","100%"),K(e,$(ee,{get rows(){return t()},columns:s,defaultSortDirection:["severity","asc"],rowSorter:d,accessors:!0,getRowID(e){return e.key},bodyRenderer:ae,style:{width:"100%"},className:"linter dark"})),e})()}function ae(e,t){const s=i(e);switch(t){case"file":return n(e);case"line":return s?`${s.start.row+1}:${s.start.column+1}`:"";case"excerpt":return e.excerpt;case"severity":return(()=>{const t=bt.cloneNode(!0);return K(t,(()=>_e[e.severity])),w((()=>t.className="solid-simple-table linter "+e.severity)),t})();default:return e[t]}}async function le(e,t){"A"!==e.target.tagName&&(("darwin"===process.platform?e.metaKey:e.ctrlKey)?e.shiftKey?c(t):await u(t,!0):await u(t))}function ue(e){const t=atom.workspace.paneContainerForItem(e);return t&&"object"==typeof t.state&&"number"==typeof t.state.size&&"function"==typeof t.render?t:null}function ce(e){const t=document.createElement("a");return t.classList.add("icon-"+e),t.appendChild(document.createTextNode("")),t}function de(e){const[i,s]=v("Loading ..."),[n,r]=v(!1);y((async()=>{if(n()){const t=e.message.description;if(console.log(t),"string"==typeof t)s(await(async e=>(void 0===fi&&(fi=(await Ve("hRY2p")).default),fi(e)))(t));else if("function"==typeof t){const e=await t();if("string"!=typeof e)throw Error("Expected result to be string, got: "+typeof e);s(e)}else console.error("[Linter] Invalid description detected, expected string or function but got:",typeof t)}})),x((()=>{e.delegate.onShouldUpdate((()=>{r(!1),s("Loading ...")})),e.delegate.onShouldExpand((()=>{r(!0)})),e.delegate.onShouldCollapse((()=>{r(!1)}))}));const{message:a,delegate:l}=e;return(()=>{const e=hi.cloneNode(!0),s=e.firstChild,d=s.firstChild,p=d.firstChild,m=d.nextSibling;return e.$$click=he,K(s,$(q,{get when(){return void 0!==a.description},get children(){const e=ai.cloneNode(!0),t=e.firstChild;return e.$$click=()=>r(!n()),w((()=>t.className="icon linter-icon icon-"+(n()?"chevron-down":"chevron-right"))),e}}),d),K(s,$(q,{get when(){return(e=>{const t=e.solutions;return!(!Array.isArray(t)||0>=t.length)})(a)},get children(){const e=li.cloneNode(!0);return U(e,"click",t(ei)((()=>(e=>{const t=e.solutions,i=o();null!==i&&Array.isArray(t)&&t.length>0&&f(i,h(t)[0])})(a))),!0),e}}),d),K(p,$(q,{get when(){return!0===l.showProviderName},get children(){return a.linterName+": "}})),K(d,(()=>a.excerpt),null),K(m,$(q,{get when(){var e;return void 0!==(null===(e=a.reference)||void 0===e?void 0:e.file)},get children(){const e=ui.cloneNode(!0);return U(e,"click",t(Tt)((()=>u(a,!0))),!0),e}}),null),K(m,$(q,{get when(){return void 0!==a.url},get children(){const e=ci.cloneNode(!0);return U(e,"click",t(Tt)((()=>c(a))),!0),e}}),null),K(e,$(q,{get when(){return n()},get children(){const e=di.cloneNode(!0);return w((()=>e.innerHTML=i())),e}}),null),w((()=>s.className="linter-excerpt "+a.severity)),e})()}async function he(e){if(!(e.target instanceof HTMLElement))return;const t=(e=>{let t=e;for(;null!==t&&!t.classList.contains("linter-line");){if(t instanceof HTMLAnchorElement)return t.href;t=t.parentElement}return null})(e.target);if(null===t)return;const{protocol:i,hostname:s,query:n}=Oe(t,!0);if("atom:"===i&&"linter"===s&&void 0!==(null==n?void 0:n.file)){const{file:e,row:t,column:i}=n;await l(Array.isArray(e)?e[0]:e,{row:void 0!==t?parseInt(Array.isArray(t)?t[0]:t,10):0,column:void 0!==i?parseInt(Array.isArray(i)?i[0]:i,10):0})}}function fe(e,t){const i=atom.views.getView(e).getComponent();t.addEventListener("mousedown",(()=>{me(i),t.addEventListener("mouseleave",(()=>{pe(i)}))}))}function pe(e){null==e||e.didFocus()}function me(e){null==e||e.didBlurHiddenInput({relatedTarget:null})}async function ge(e){if(e.preventDefault(),e.ctrlKey&&"c"===e.key){var t,i;const e=null!==(t=null===(i=document.getSelection())||void 0===i?void 0:""+i)&&void 0!==t?t:"";await navigator.clipboard.writeText(e)}}function ve(e){return(()=>{const t=mi.cloneNode(!0);return K(t,$(H,{get each(){return e.messages},children(t){return $(q,{get when(){return 2===t.version},get children(){return $(de,{get key(){return t.key},get delegate(){return e.delegate},message:t})}})}})),t})()}function we(e,t){if(e.largeFileMode)return 1e5;const i=e.getLineCount();return t>i?0:i}function ye(e,t,i=e.getLineCount()){const s=e.getBuffer();for(let e=0,n=i;n>e;e++){const i=s.lineLengthForRow(e);if(i>t)return i}return 0}function be(e,t,i=!1){let s=null;i&&(s=e.querySelector("linter-decoration")),null!==s?s.className="":(s=document.createElement("linter-decoration"),e.appendChild(s)),t.error?s.classList.add("linter-error"):t.warning?s.classList.add("linter-warning"):t.info&&s.classList.add("linter-info")}function ke(e){var t;null===(t=e.querySelector("linter-decoration"))||void 0===t||t.remove()}function Pe(){atom.config.get("linter-ui-default.useBusySignal")&&atom.packages.getLoadedPackage("linter-ui-default").metadata["package-deps"].push("busy-signal");const e=window.requestIdleCallback((()=>{Pi.delete(e);{const{install:e}=Te;e("linter-ui-default")}}));Pi.add(e)}function xe(){Pi.forEach((e=>window.cancelIdleCallback(e))),Pi.clear();for(const e of xi)e.dispose();xi.clear()}function Ce(){const e=new ki;return xi.add(e),Ci&&e.signal.attach(Ci),e}function Ee(){return Array.from(xi).map((e=>e.intentions))}function Se(e){Ci=e,xi.forEach((e=>{e.signal.attach(Ci)}))}function Le(e){Ei=e,xi.forEach((e=>{e.statusBar.attach(Ei)}))}var Te=require("atom-package-deps"),Me=require("atom"),Ne=Me.CompositeDisposable,Ie=Me.Emitter,Ae=Me.Disposable,Be=Me.Range,De=require("electron").shell,Re=t(require("assert")),Fe=t(require("disposable-event")),Oe=require("url").parse,je=t(require("path")),$e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},He={},qe={},Ve=$e.parcelRequiree95c;null==Ve&&((Ve=e=>{if(e in He)return He[e].exports;if(e in qe){let t=qe[e];delete qe[e];let i={id:e,exports:{}};return He[e]=i,t.call(i.exports,i,i.exports),i.exports}var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}).register=(e,t)=>{qe[e]=t},$e.parcelRequiree95c=Ve),e(module.exports,"consumeSignal",(()=>Se)),e(module.exports,"provideUI",(()=>Ce)),e(module.exports,"provideIntentions",(()=>Ee)),e(module.exports,"deactivate",(()=>xe)),e(module.exports,"consumeStatusBar",(()=>Le)),e(module.exports,"activate",(()=>Pe));let We=null;const Ge={error:3,warning:2,info:1},_e={error:"Error",warning:"Warning",info:"Info"},ze=["center","bottom"];class Ue{constructor(){this.emitter=new Ie,this.messages=[],this.filteredMessages=[],this.subscriptions=new Ne;let e=null;this.subscriptions.add(atom.config.observe("linter-ui-default.panelRepresents",(e=>{const t=void 0!==this.panelRepresents;this.panelRepresents=e,t&&this.update()})),atom.workspace.getCenter().observeActivePaneItem((()=>{e&&(e.dispose(),e=null);const t=o();if(t){"Entire Project"!==this.panelRepresents&&this.update();let i=-1;e=t.onDidChangeCursorPosition((({newBufferPosition:e})=>{i!==e.row&&"Current Line"===this.panelRepresents&&(i=e.row,this.update())}))}("Entire Project"!==this.panelRepresents||t)&&this.update()})),new Ae((()=>{e&&e.dispose()})))}getFilteredMessages(){let e=[];if("Entire Project"===this.panelRepresents)e=this.messages;else if("Current File"===this.panelRepresents){const t=o();if(!t)return[];e=r(this.messages,t.getPath())}else if("Current Line"===this.panelRepresents){const t=o();if(!t)return[];const i=t.getCursors()[0].getBufferRow();e=a(this.messages,t.getPath(),Be.fromObject([[i,0],[i,1/0]]))}return e}update(e=null){Array.isArray(e)&&(this.messages=e),this.filteredMessages=this.getFilteredMessages(),this.emitter.emit("observe-messages",this.filteredMessages)}onDidChangeMessages(e){return this.emitter.on("observe-messages",e)}dispose(){this.subscriptions.dispose()}}const Ke={},Ye=(e,t)=>e===t;let Je=null,Qe=I;const Xe={},Ze={owned:null,cleanups:null,context:null,owner:null},[et,tt]=v(!1);var it=null,st=null;let nt=null,ot=null,rt=null,at=null,lt=0;Symbol(),Symbol(),Symbol(),Symbol();const ut=Symbol();(e=>{Symbol()})(),new Set(["className","indeterminate","value","allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","truespeed"]),new Set(["innerHTML","textContent","innerText","children"]),new Set(["beforeinput","click","dblclick","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]);const ct=Symbol(),dt=G("<table><thead><tr></tr></thead><tbody></tbody></table>",8),ht=G("<th></th>",2),ft=G("<tr></tr>",2),pt=G("<td></td>",2),mt=G('<span class="sort-icon"></span>',2),gt="↑",vt="↓",wt="⇅";_(["click"]);const yt=G('<div id="linter-panel"></div>',2),bt=G("<div></div>",2);class kt{constructor(e){this.element=document.createElement("div"),this.subscriptions=new Ne,this.panelHeight=100,this.alwaysTakeMinimumSpace=!0,this.subscriptions.add(atom.config.observe("linter-ui-default.panelHeight",(e=>{const t="number"==typeof this.panelHeight;this.panelHeight=e,t&&this.doPanelResize(!0)})),atom.config.observe("linter-ui-default.alwaysTakeMinimumSpace",(e=>{this.alwaysTakeMinimumSpace=e}))),this.doPanelResize(),W((()=>$(re,{delegate:e})),this.element)}doPanelResize(e=!1){const t=ue(this);if(null===t)return;let i=null;const s=atom.views.getView(t);if(s&&this.alwaysTakeMinimumSpace){const e=s.querySelector(".list-inline.tab-bar.inset-panel"),t=e?e.getClientRects()[0]:null,n=this.element.querySelector("table"),o=n?n.getClientRects()[0]:null;t&&o&&(i=t.height+o.height+1)}let n=null;const o=null===i||e?this.panelHeight:Math.min(i,this.panelHeight);void 0===this.lastSetPaneHeight||t.state.size===this.lastSetPaneHeight||e||(n=t.state.size),this.lastSetPaneHeight=o,t.state.size=o,t.render(t.state),null!==n&&atom.config.set("linter-ui-default.panelHeight",n)}getURI(){return"atom://linter-ui-default"}getTitle(){return"Linter"}getDefaultLocation(){return"bottom"}getAllowedLocations(){return ze}getPreferredHeight(){return atom.config.get("linter-ui-default.panelHeight")}dispose(){this.subscriptions.dispose();const e=ue(this);var t;null===e||this.alwaysTakeMinimumSpace||e.state.size===this.panelHeight||(atom.config.set("linter-ui-default.panelHeight",e.state.size),null===(t=e.paneForItem(this))||void 0===t||t.destroyItem(this,!0))}}class Pt{constructor(){this.panel=null,this.element=document.createElement("div"),this.delegate=new Ue,this.messages=[],this.deactivating=!1,this.subscriptions=new Ne,this.showPanelConfig=!0,this.hidePanelWhenEmpty=!0,this.showPanelStateMessages=!1,this.subscriptions.add(this.delegate,atom.config.observe("linter-ui-default.hidePanelWhenEmpty",(async e=>{this.hidePanelWhenEmpty=e,await this.refresh()})),atom.workspace.onDidDestroyPane((({pane:e})=>{(null===this.panel||e.getItems().includes(this.panel))&&!this.deactivating&&(this.panel=null,atom.config.set("linter-ui-default.showPanel",!1))})),atom.workspace.onDidDestroyPaneItem((({item:e})=>{e instanceof kt&&!this.deactivating&&(this.panel=null,atom.config.set("linter-ui-default.showPanel",!1))})),atom.config.observe("linter-ui-default.showPanel",(async e=>{this.showPanelConfig=e,await this.refresh()})),atom.workspace.getCenter().observeActivePaneItem((async()=>{this.showPanelStateMessages=!!this.delegate.filteredMessages.length,await this.refresh()}))),this.activationTimer=window.requestIdleCallback((async()=>{let e=!0;const t=atom.workspace.getBottomDock();this.subscriptions.add(t.onDidChangeActivePaneItem((t=>{this.panel&&"bottom"===this.getPanelLocation()&&(e?e=!1:t===this.panel!==this.showPanelConfig&&atom.config.set("linter-ui-default.showPanel",!this.showPanelConfig))})),t.onDidChangeVisible((e=>{this.panel&&"bottom"===this.getPanelLocation()&&(!e&&this.showPanelConfig&&this.hidePanelWhenEmpty&&!this.showPanelStateMessages||t.getActivePaneItem()===this.panel&&e!==this.showPanelConfig&&atom.config.set("linter-ui-default.showPanel",!this.showPanelConfig))}))),await this.activate()}))}getPanelLocation(){if(!this.panel)return null;const e=atom.workspace.paneContainerForItem(this.panel);return null==e?void 0:e.location}async activate(){this.panel||(this.panel=new kt(this.delegate),await atom.workspace.open(this.panel,{activatePane:!1,activateItem:!1,searchAllPanes:!0}),await this.update(),await this.refresh())}async update(e=null){e&&(this.messages=e),this.delegate.update(this.messages),this.showPanelStateMessages=!!this.delegate.filteredMessages.length,await this.refresh()}async refresh(){const e=this.panel;if(null===e)return void(this.showPanelConfig&&await this.activate());const t=atom.workspace.paneContainerForItem(e);if("bottom"!==(null==t?void 0:t.location))return;const i=t.getActivePaneItem()===e;var s;!this.showPanelConfig||this.hidePanelWhenEmpty&&!this.showPanelStateMessages?i&&t.hide():(i||null===(s=t.paneForItem(e))||void 0===s||s.activateItem(e),t.show(),e.doPanelResize())}dispose(){this.deactivating=!0,this.panel&&this.panel.dispose(),this.subscriptions.dispose(),window.cancelIdleCallback(this.activationTimer)}}class xt{constructor(){this.messages=[],this.subscriptions=new Ne,this.subscriptions.add(atom.commands.add("atom-workspace",{"linter-ui-default:next":()=>this.move(!0,!0),"linter-ui-default:previous":()=>this.move(!1,!0),"linter-ui-default:next-error":()=>this.move(!0,!0,"error"),"linter-ui-default:previous-error":()=>this.move(!1,!0,"error"),"linter-ui-default:next-warning":()=>this.move(!0,!0,"warning"),"linter-ui-default:previous-warning":()=>this.move(!1,!0,"warning"),"linter-ui-default:next-info":()=>this.move(!0,!0,"info"),"linter-ui-default:previous-info":()=>this.move(!1,!0,"info"),"linter-ui-default:next-in-current-file":()=>this.move(!0,!1),"linter-ui-default:previous-in-current-file":()=>this.move(!1,!1),"linter-ui-default:next-error-in-current-file":()=>this.move(!0,!1,"error"),"linter-ui-default:previous-error-in-current-file":()=>this.move(!1,!1,"error"),"linter-ui-default:next-warning-in-current-file":()=>this.move(!0,!1,"warning"),"linter-ui-default:previous-warning-in-current-file":()=>this.move(!1,!1,"warning"),"linter-ui-default:next-info-in-current-file":()=>this.move(!0,!1,"info"),"linter-ui-default:previous-info-in-current-file":()=>this.move(!1,!1,"info"),"linter-ui-default:toggle-panel"(){atom.config.set("linter-ui-default.showPanel",!atom.config.get("linter-ui-default.showPanel"))},"linter-ui-default:expand-tooltip"(){},"linter-ui-default:collapse-tooltip"(){}}),atom.commands.add("atom-text-editor:not([mini])",{"linter-ui-default:apply-all-solutions":()=>this.applyAllSolutions()}),atom.commands.add("#linter-panel",{"core:copy"(){const e=document.getSelection();e&&atom.clipboard.write(""+e)}}))}applyAllSolutions(){const e=o();Re(e,"textEditor was null on a command supposed to run on text-editors only"),d(r(this.messages,e.getPath()),["line","desc"]).forEach((t=>{2===t.version&&Array.isArray(t.solutions)&&t.solutions.length>0&&f(e,h(t.solutions)[0])}))}async move(e,t,n=null){const a=o();var l;const c=null!==(l=null==a?void 0:a.getPath())&&void 0!==l?l:NaN,h=d(r(this.messages,t?null:c,n),["file","asc"]),f=e?-1:1;if(!a){const t=e?h[0]:h[h.length-1];return void(t&&await u(t))}const p=a.getCursorBufferPosition();e||h.reverse();let m=null,g=!1;for(let e=0,t=h.length;t>e;e++){const t=h[e],n=s(t),o=i(t);if(g||n!==c||(g=!0),"string"==typeof n&&o){if(g&&n!==c){m=t;break}if(n===c&&p.compare(o.start)===f){m=t;break}}}!m&&h.length&&(m=h[0]),m&&await u(m)}update(e){this.messages=e}dispose(){this.subscriptions.dispose()}}class Ct{constructor(){this.item=document.createElement("div"),this.itemErrors=ce("stop"),this.itemWarnings=ce("alert"),this.itemInfos=ce("info"),this.emitter=new Ie,this.subscriptions=new Ne,this.item.appendChild(this.itemErrors),this.item.appendChild(this.itemWarnings),this.item.appendChild(this.itemInfos),this.item.classList.add("inline-block"),this.item.classList.add("linter-status-count"),this.subscriptions.add(this.emitter,atom.tooltips.add(this.itemErrors,{title:"Linter Errors"}),atom.tooltips.add(this.itemWarnings,{title:"Linter Warnings"}),atom.tooltips.add(this.itemInfos,{title:"Linter Infos"})),this.itemErrors.onclick=()=>this.emitter.emit("click","error"),this.itemWarnings.onclick=()=>this.emitter.emit("click","warning"),this.itemInfos.onclick=()=>this.emitter.emit("click","info"),this.update(0,0,0)}setVisibility(e,t){t?this.item.classList.remove("hide-"+e):this.item.classList.add("hide-"+e)}update(e,t,i){this.itemErrors.childNodes[0].textContent=e+"",this.itemWarnings.childNodes[0].textContent=t+"",this.itemInfos.childNodes[0].textContent=i+"",e?this.itemErrors.classList.add("text-error"):this.itemErrors.classList.remove("text-error"),t?this.itemWarnings.classList.add("text-warning"):this.itemWarnings.classList.remove("text-warning"),i?this.itemInfos.classList.add("text-info"):this.itemInfos.classList.remove("text-info")}onDidClick(e){return this.emitter.on("click",e)}dispose(){this.subscriptions.dispose()}}class Et{constructor(){this.element=new Ct,this.messages=[],this.subscriptions=new Ne,this.subscriptions.add(this.element,atom.config.observe("linter-ui-default.statusBarRepresents",(e=>{const t=void 0!==this.statusBarRepresents;this.statusBarRepresents=e,t&&this.update()})),atom.config.observe("linter-ui-default.statusBarClickBehavior",(e=>{const t=void 0!==this.statusBarClickBehavior;this.statusBarClickBehavior=e,t&&this.update()})),atom.config.observe("linter-ui-default.showStatusBar",(e=>{this.element.setVisibility("config",e)})),atom.workspace.getCenter().observeActivePaneItem((e=>{const t=atom.workspace.isTextEditor(e);this.element.setVisibility("pane",t),t&&"Current File"===this.statusBarRepresents&&this.update()}))),this.element.onDidClick((async e=>{const t=atom.views.getView(atom.workspace);if("Toggle Panel"===this.statusBarClickBehavior)await atom.commands.dispatch(t,"linter-ui-default:toggle-panel");else if("Toggle Status Bar Scope"===this.statusBarClickBehavior)atom.config.set("linter-ui-default.statusBarRepresents","Entire Project"===this.statusBarRepresents?"Current File":"Entire Project");else{const i="Current File"===this.statusBarRepresents?"-in-current-file":"";await atom.commands.dispatch(t,`linter-ui-default:next-${e}${i}`)}}))}update(e){void 0!==e?this.messages=e:e=this.messages;const t={error:0,warning:0,info:0},i=o();var n;const r=null!==(n=null==i?void 0:i.getPath())&&void 0!==n?n:NaN;e.forEach((e=>{"Entire Project"!==this.statusBarRepresents&&s(e)!==r||("error"===e.severity?t.error++:"warning"===e.severity?t.warning++:t.info++)})),this.element.update(t.error,t.warning,t.info)}attach(e){let t=null;this.subscriptions.add(atom.config.observe("linter-ui-default.statusBarPosition",(i=>{t&&t.destroy(),t=e[`add${i}Tile`]({item:this.element.item,priority:"Left"===i?0:1e3})}))),this.subscriptions.add(new Ae((()=>{t&&t.destroy()})))}dispose(){this.subscriptions.dispose()}}class St{constructor(){this.executing=new Set,this.providerTitles=new Set,this.useBusySignal=!0,this.subscriptions=new Ne,this.subscriptions.add(atom.config.observe("linter-ui-default.useBusySignal",(e=>{this.useBusySignal=e})))}attach(e){this.provider=e.create(),this.update()}update(){const e=this.provider;if(!e)return;if(!this.useBusySignal)return;const t=new Map,i=new Set;for(const{filePath:e,linter:i}of this.executing){let s=t.get(e);s||t.set(e,s=[]),s.push(i.name)}for(const[s,n]of t){const t="string"==typeof s?" on "+atom.project.relativizePath(s)[1]:"";n.forEach((s=>{const n=`${s}${t}`;i.add(n),this.providerTitles.has(n)||(this.providerTitles.add(n),e.add(n))}))}this.providerTitles.forEach((t=>{i.has(t)||(e.remove(t),this.providerTitles.delete(t))})),t.clear()}getExecuting(e,t){for(const i of this.executing)if(i.linter===e&&i.filePath===t)return i;return null}didBeginLinting(e,t){this.getExecuting(e,t)||(this.executing.add({linter:e,filePath:t}),this.update())}didFinishLinting(e,t){const i=this.getExecuting(e,t);i&&(this.executing.delete(i),this.update())}dispose(){this.provider&&this.provider.clear(),this.providerTitles.clear(),this.executing.clear(),this.subscriptions.dispose()}}class Lt{getIntentions({textEditor:e,bufferPosition:t}){let s=[];const n=r(this.messages,e.getPath());for(const r of n){const n=r.solutions,a=Array.isArray(n)&&n.length>0;if(!a&&"function"!=typeof n)continue;const l=i(r);if(!0!==(null==l?void 0:l.containsPoint(t)))continue;const u=r.linterName||"Linter";var o;2===r.version&&a&&(s=s.concat(n.map((t=>({priority:"number"==typeof t.priority?t.priority+200:200,icon:"tools",title:null!==(o=t.title)&&void 0!==o?o:`Fix ${u} issue`,selected(){f(e,t)}})))))}return s}update(e){this.messages=e}constructor(){this.messages=[],this.grammarScopes=["*"]}}var Tt,Mt;Mt=e=>{var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Nt,It={},At="object"==typeof self&&self&&self.Object===Object&&self,Bt="object"==typeof $e&&$e&&$e.Object===Object&&$e||At||Function("","return this")();Nt=()=>It.Date.now();var Dt,Rt,Ft,Ot=/\s/;Ft=e=>{for(var t=e.length;t--&&Ot.test(e.charAt(t)););return t},Rt=e=>e?e.slice(0,Ft(e)+1).replace(/^\s+/,""):e;var jt,$t,Ht,qt,Vt=Object.prototype,Wt=Vt.hasOwnProperty,Gt=Vt.toString,_t=(jt=(It=Bt).Symbol)?jt.toStringTag:void 0;qt=e=>{var t=Wt.call(e,_t),i=e[_t];try{e[_t]=void 0;var s=!0}catch(e){}var n=Gt.call(e);return s&&(t?e[_t]=i:delete e[_t]),n};var zt,Ut={}.toString;zt=e=>Ut.call(e);var Kt,Yt=jt?jt.toStringTag:void 0;Ht=e=>null==e?void 0===e?"[object Undefined]":"[object Null]":Yt&&Yt in Object(e)?qt(e):zt(e),Kt=e=>null!=e&&"object"==typeof e,$t=e=>"symbol"==typeof e||Kt(e)&&"[object Symbol]"==Ht(e);var Jt=/^[-+]0x[0-9a-f]+$/i,Qt=/^0b[01]+$/i,Xt=/^0o[0-7]+$/i,Zt=parseInt;Dt=e=>{if("number"==typeof e)return e;if($t(e))return NaN;if(Mt(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Mt(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Rt(e);var i=Qt.test(e);return i||Xt.test(e)?Zt(e.slice(2),i?2:8):Jt.test(e)?NaN:+e};var ei,ti,ii,si,ni=Math.max,oi=Math.min;Tt=function(e,t,i){function s(t){var i=u,s=c;return u=c=void 0,m=t,h=e.apply(s,i)}function n(e){return m=e,f=setTimeout(r,t),g?s(e):h}function o(e){var i=e-p;return void 0===p||i>=t||0>i||v&&e-m>=d}function r(){var e=Nt();if(o(e))return a(e);f=setTimeout(r,(e=>{var i=t-(e-p);return v?oi(i,d-(e-m)):i})(e))}function a(e){return f=void 0,w&&u?s(e):(u=c=void 0,h)}function l(){var e=Nt(),i=o(e);if(u=arguments,c=this,p=e,i){if(void 0===f)return n(p);if(v)return clearTimeout(f),f=setTimeout(r,t),s(p)}return void 0===f&&(f=setTimeout(r,t)),h}var u,c,d,h,f,p,m=0,g=!1,v=!1,w=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return t=Dt(t)||0,Mt(i)&&(g=!!i.leading,d=(v="maxWait"in i)?ni(Dt(i.maxWait)||0,t):d,w="trailing"in i?!!i.trailing:w),l.cancel=()=>{void 0!==f&&clearTimeout(f),m=0,u=p=c=f=void 0},l.flush=()=>void 0===f?h:a(Nt()),l};class ri{constructor(){this.emitter=new Ie,this.expanded=!1,this.subscriptions=new Ne,this.subscriptions.add(this.emitter,atom.config.observe("linter-ui-default.showProviderName",(e=>{const t=void 0!==this.showProviderName;this.showProviderName=e,t&&this.emitter.emit("should-update")})),atom.commands.add("atom-workspace",{"linter-ui-default:expand-tooltip":e=>{var t;this.expanded||(this.expanded=!0,this.emitter.emit("should-expand"),!0===(null===(t=e.originalEvent)||void 0===t?void 0:t.isTrusted)&&document.body.addEventListener("keyup",(async function e(){document.body.removeEventListener("keyup",e),await atom.commands.dispatch(atom.views.getView(atom.workspace),"linter-ui-default:collapse-tooltip")}),{passive:!0}))},"linter-ui-default:collapse-tooltip":()=>{this.expanded=!1,this.emitter.emit("should-collapse")}}))}onShouldUpdate(e){return this.emitter.on("should-update",e)}onShouldExpand(e){return this.emitter.on("should-expand",e)}onShouldCollapse(e){return this.emitter.on("should-collapse",e)}dispose(){this.emitter.dispose()}}si=e=>e?1/0===(e=Dt(e))||-1/0===e?17976931348623157e292*(0>e?-1:1):e==e?e:0:0===e?e:0,ii=e=>{var t=si(e),i=t%1;return t==t?i?t-i:t:0},ti=function(e,t){var i;if("function"!=typeof t)throw new TypeError("Expected a function");return e=ii(e),function(){return--e>0&&(i=t.apply(this,arguments)),e>1||(t=void 0),i}},ei=e=>ti(2,e);const ai=G("<a><span></span></a>",4),li=G('<button class="btn fix-btn">Fix</button>',2),ui=G('<a><span class="icon linter-icon icon-alignment-aligned-to"></span></a>',4),ci=G('<a><span class="icon linter-icon icon-link"></span></a>',4),di=G('<div class="linter-line"></div>',2),hi=G('<div class="linter-message"><div><div class="linter-text"><div class="provider-name"></div></div><div class="linter-buttons-right"></div></div></div>',10);let fi;Ve.register("hRY2p",((e,t)=>{e.exports=Promise.resolve(require("./marked.esm.171c7c5e.js")).then((()=>Ve("kt143")))})),_(["click"]);var pi={};Object.defineProperty(pi,"__esModule",{value:!0}),pi.makeOverlaySelectable=(e,t,i=!0)=>{t.setAttribute("tabindex","-1"),t.style.userSelect&&"none"!==t.style.userSelect||(t.style.userSelect="text"),i&&fe(e,t),t.classList.add("native-key-bindings")},pi.overlayFocusFix=fe,pi.focusEditor=pe,pi.blurEditor=me,pi.makeOverLayCopyable=e=>{e.addEventListener("mouseenter",(()=>{e.addEventListener("keydown",ge)})),e.addEventListener("mouseleave",(()=>{e.removeEventListener("keydown",ge)}))},pi.copyListener=ge;const mi=G('<div class="linter-messages"></div>',2);class gi{constructor(e,t,i){this.element=document.createElement("div"),this.emitter=new Ie,this.subscriptions=new Ne,this.messages=e,this.marker=i.markBufferRange([t,t]),this.marker.onDidDestroy((()=>this.emitter.emit("did-destroy")));const s=new ri;var n,o,r;pi.makeOverlaySelectable(i,this.element),this.element.id="linter-tooltip",i.decorateMarker(this.marker,{type:"overlay",item:this.element}),this.subscriptions.add(this.emitter,s),W((()=>$(ve,{messages:e,delegate:s})),this.element),n=this.element,o=t,r=i,setTimeout((()=>{const e=n.getBoundingClientRect().height,t=r.getLineHeightInPixels();if((o.row-r.getFirstVisibleScreenRow())*t>e){const i=n.parentElement;null!==i&&(i.style.transform=`translateY(-${2+t+e}px)`)}else{const e=r.getElement().querySelector(".datatip-overlay");if(null!==e){const t=n.parentElement;null!==t&&(t.style.transform=`translateY(${e.clientHeight}px)`)}}n.style.visibility="visible"}),50)}isValid(e,t){if(1!==this.messages.length||!t.has(this.messages[0].key))return!1;const s=i(this.messages[0]);return!0===(null==s?void 0:s.containsPoint(e))}onDidDestroy(e){return this.emitter.on("did-destroy",e)}dispose(){this.emitter.emit("did-destroy"),this.subscriptions.dispose()}}class vi{constructor(e){this.gutter=null,this.tooltip=null,this.emitter=new Ie,this.markers=new Map,this.messages=new Map,this.showTooltip=!0,this.subscriptions=new Ne,this.cursorPosition=null,this.tooltipFollows="Both",this.showProviderName=!0,this.ignoreTooltipInvocation=!1,this.currentLineMarker=null,this.lastCursorPositions=new WeakMap,this.textEditor=e;let t=null;this.subscriptions.add(this.emitter,e.onDidDestroy((()=>{this.dispose()})),new Ae((()=>{null==t||t.dispose()})),atom.config.observe("linter-ui-default.showProviderName",(e=>{this.showProviderName=e})),atom.config.observe("linter-ui-default.showDecorations",(e=>{const t=void 0!==this.showDecorations;this.showDecorations=e,t&&this.updateGutter()})),atom.config.observe("linter-ui-default.gutterPosition",(e=>{const t=void 0!==this.gutterPosition;this.gutterPosition=e,t&&this.updateGutter()})),atom.config.observe("linter-ui-default.showTooltip",(e=>{this.showTooltip=e,!this.showTooltip&&this.tooltip&&this.removeTooltip()})),atom.config.observe("linter-ui-default.tooltipFollows",(e=>{this.tooltipFollows=e,t&&t.dispose(),t=new Ne,"Mouse"!==e&&"Both"!==e||t.add(this.listenForMouseMovement()),"Keyboard"!==e&&"Both"!==e||t.add(this.listenForKeyboardMovement()),this.removeTooltip()})),e.onDidChangeCursorPosition((({cursor:e,newBufferPosition:t})=>{const i=this.lastCursorPositions.get(e);i&&i.isEqual(t)||(this.lastCursorPositions.set(e,t),this.ignoreTooltipInvocation=!1),"Mouse"===this.tooltipFollows&&this.removeTooltip()})),e.getBuffer().onDidChangeText((()=>{e.getCursors().forEach((e=>{this.lastCursorPositions.set(e,e.getBufferPosition())})),"Mouse"!==this.tooltipFollows&&(this.ignoreTooltipInvocation=!0,this.removeTooltip())}))),this.updateGutter(),this.listenForCurrentLine()}listenForCurrentLine(){this.subscriptions.add(this.textEditor.observeCursors((e=>{const t=({start:e,end:t})=>{var i;const s=this.gutter;if(!s||this.subscriptions.disposed)return;const n=Be.fromObject([e,t]),o=Be.fromObject([[e.row,0],[t.row,1/0]]),r=n.isEmpty();if(e.row!==t.row&&0===n.end.column&&o.end.row--,!0===(null===(i=this.lastRange)||void 0===i?void 0:i.isEqual(o))&&r===this.lastIsEmpty)return;this.currentLineMarker&&(this.currentLineMarker.destroy(),this.currentLineMarker=null),this.lastRange=o,this.lastIsEmpty=r,this.currentLineMarker=this.textEditor.markScreenRange(o,{invalidate:"never"});const a=document.createElement("span");a.className="line-number cursor-line linter-cursor-line "+(r?"cursor-line-no-selection":""),s.decorateMarker(this.currentLineMarker,{item:a,class:"linter-row"})},i=e.getMarker(),s=new Ne;s.add(i.onDidChange((({newHeadScreenPosition:e,newTailScreenPosition:i})=>{t({start:e,end:i})})),e.onDidDestroy((()=>{this.subscriptions.remove(s),s.dispose()})),new Ae((()=>{this.currentLineMarker&&(this.currentLineMarker.destroy(),this.currentLineMarker=null)}))),this.subscriptions.add(s),t(i.getScreenRange())})))}listenForMouseMovement(){const e=atom.views.getView(this.textEditor);return Fe(e,"mousemove",t(Tt)((t=>{if(!e.getComponent()||this.subscriptions.disposed||!((e,t)=>{let i=e;if(null===i)return!1;do{if(i.matches("div.scroll-view"))return!0;i=i.parentElement}while(null!==i&&"HTML"!==i.nodeName);return!1})(t.target))return;const i=this.tooltip;i&&(({event:e,editor:t,editorElement:i,tooltipElement:s,screenPosition:n})=>{const o=i.getComponent().pixelPositionForMouseEvent(e),r=i.pixelPositionForScreenPosition(n),a=o.top-r.top,l=o.left-r.left,u=t.getLineHeightInPixels();if(a>0){if(a>s.offsetHeight+u+1.5*u)return!1}else if(0>a&&-1.5*u>a)return!1;if(l>0){if(l>s.offsetWidth+30)return!1}else if(0>l&&-30>l)return!1;return!0})({event:t,editor:this.textEditor,editorElement:e,tooltipElement:i.element,screenPosition:i.marker.getStartScreenPosition()})||(this.cursorPosition=((e,t,i)=>{const s=i.getComponent().pixelPositionForMouseEvent(e),n=i.getComponent().screenPositionForPixelPosition(s);if(Number.isNaN(n.row)||Number.isNaN(n.column))return null;const o=i.pixelPositionForScreenPosition(n),r=s.top-o.top,a=s.left-o.left;return(0===r||r>0&&20>r||0>r&&r>-20)&&(0===a||a>0&&20>a||0>a&&a>-20)?t.bufferPositionForScreenPosition(n):null})(t,this.textEditor,e),this.ignoreTooltipInvocation=!1,this.cursorPosition?this.updateTooltip(this.cursorPosition):this.removeTooltip())}),100),{passive:!0})}listenForKeyboardMovement(){return this.textEditor.onDidChangeCursorPosition(t(Tt)((({newBufferPosition:e})=>{this.cursorPosition=e,this.updateTooltip(e)}),16))}updateGutter(){this.removeGutter(),!0===this.showDecorations?(this.gutter=this.textEditor.addGutter({name:"linter-ui-default",priority:"Left"===this.gutterPosition?-100:100}),this.markers.forEach(((e,t)=>{const i=this.messages.get(t);if(i)for(const t of e)this.decorateMarker(i,t,"gutter")}))):this.gutter=null}removeGutter(){if(this.gutter)try{this.gutter.destroy()}catch(e){}}updateTooltip(e){var t;if(!e||!0===(null===(t=this.tooltip)||void 0===t?void 0:t.isValid(e,this.messages)))return;if(this.removeTooltip(),!this.showTooltip)return;if(this.ignoreTooltipInvocation)return;const i=a(this.messages,this.textEditor.getPath(),e);if(!i.length)return;this.tooltip=new gi(i,e,this.textEditor);const s=this.tooltip.marker;i.forEach((e=>{this.saveMarker(e.key,s)})),this.tooltip.onDidDestroy((()=>{this.tooltip=null}))}removeTooltip(){this.tooltip&&this.tooltip.marker.destroy()}applyChanges(e,t){const s=this.textEditor.getBuffer();for(let e=0,i=t.length;i>e;e++)this.destroyMarker(t[e].key);for(let t=0,n=e.length;n>t;t++){const n=e[t],o=i(n);if(!o)continue;const r=s.markRange(o,{invalidate:"never"});this.decorateMarker(n,r),r.onDidChange((({oldHeadPosition:e,newHeadPosition:t,isValid:i})=>{!i||0===t.row&&0!==e.row||2===n.version&&(n.location.position=r.previousEventState.range)}))}this.updateTooltip(this.cursorPosition)}decorateMarker(e,t,i="both"){this.saveMarker(e.key,t),this.messages.set(e.key,e),"both"!==i&&"editor"!==i||this.textEditor.decorateMarker(t,{type:"text",class:"linter-highlight linter-"+e.severity});const s=this.gutter;if(s&&("both"===i||"gutter"===i)){const i=document.createElement("span");var n;i.className=`linter-gutter linter-gutter-${e.severity} icon icon-${null!==(n=e.icon)&&void 0!==n?n:"primitive-dot"}`,s.decorateMarker(t,{class:"linter-row",item:i})}}saveMarker(e,t){var i;const s=null!==(i=this.markers.get(e))&&void 0!==i?i:[];s.push(t),this.markers.set(e,s)}destroyMarker(e){const t=this.markers.get(e);t&&t.forEach((e=>{null==e||e.destroy()})),this.markers.delete(e),this.messages.delete(e)}onDidDestroy(e){return this.emitter.on("did-destroy",e)}dispose(){this.emitter.emit("did-destroy"),this.subscriptions.dispose(),this.removeGutter(),this.removeTooltip()}}var wi={};Object.defineProperty(wi,"__esModule",{value:!0}),wi.lineLengthIfLong=wi.lineCountIfLarge=wi.largeness=void 0,wi.largeness=(e,t=atom.config.get("atom-ide-base.largeLineCount")||4e3,i=atom.config.get("atom-ide-base.longLineLength")||4e3)=>{const s=we(e,t);if(0!==s)return s;const n=ye(e,i);return 0!==n?n:0},wi.lineCountIfLarge=we,wi.lineLengthIfLong=ye;class yi{constructor(){this.editors=new Set,this.messages=[],this.firstRender=!0,this.subscriptions=new Ne;const e=atom.config.get("linter-ui-default.largeFileLineCount"),t=atom.config.get("linter-ui-default.longLineLength");this.subscriptions.add(atom.workspace.observeTextEditors((i=>{if(wi.largeness(i,e,t)){const e=atom.notifications.addWarning("Linter: Large/Minified file detected",{detail:"Adding inline linter markers are skipped for this file for performance reasons (linter pane is still active)",dismissable:!0,buttons:[{text:"Force enable",onDidClick:()=>{this.getEditor(i),e.dismiss()}},{text:"Change threshold",async onDidClick(){await atom.workspace.open("atom://config/packages/linter-ui-default"),document.querySelectorAll(".control-group")[16].scrollIntoView(),e.dismiss()}}]});setTimeout((()=>{e.dismiss()}),5e3)}else this.getEditor(i)})),atom.workspace.getCenter().observeActivePaneItem((e=>{this.editors.forEach((t=>{t.textEditor!==e&&t.removeTooltip()}))})))}isFirstRender(){return this.firstRender}update({messages:e,added:t,removed:i}){this.messages=e,this.firstRender=!1;const{editorsMap:n,filePaths:o}=(e=>{const t=new Map,i=[];for(const n of e.editors){var s;const e=null!==(s=n.textEditor.getPath())&&void 0!==s?s:"";t.has(e)?t.get(e).editors.push(n):(t.set(e,{added:[],removed:[],editors:[n]}),i.push(e))}return{editorsMap:t,filePaths:i}})(this);t.forEach((e=>{if(!e||!e.location)return;const t=s(e);"string"==typeof t&&n.has(t)&&n.get(t).added.push(e)})),i.forEach((e=>{if(!e||!e.location)return;const t=s(e);"string"==typeof t&&n.has(t)&&n.get(t).removed.push(e)})),o.forEach((e=>{if(n.has(e)){const{added:t,removed:i,editors:s}=n.get(e);(t.length||i.length)&&s.forEach((e=>e.applyChanges(t,i)))}}))}getEditor(e){for(const t of this.editors)if(t.textEditor===e)return t;const t=new vi(e);return this.editors.add(t),t.onDidDestroy((()=>{this.editors.delete(t)})),t.subscriptions.add(e.onDidChangePath((()=>{t.dispose(),this.getEditor(e)}))),t.subscriptions.add(e.onDidChangeGrammar((()=>{t.dispose(),this.getEditor(e)}))),t.applyChanges(r(this.messages,e.getPath()),[]),t}dispose(){for(const e of this.editors)e.dispose();this.subscriptions.dispose()}}class bi{constructor(){this.messages=[],this.decorations={},this.subscriptions=new Ne,this.subscriptions.add(atom.config.observe("linter-ui-default.decorateOnTreeView",(e=>{if(void 0===this.decorateOnTreeView)this.decorateOnTreeView=e;else if("None"===e)this.update([]),this.decorateOnTreeView=e;else{const t=this.messages;this.decorateOnTreeView=e,this.update(t)}}))),setTimeout((()=>{const e=bi.getElement();e&&this.subscriptions.add(Fe(e,"click",t(Tt)((()=>{this.update()})),{passive:!0}))}),100)}update(e=null){Array.isArray(e)&&(this.messages=e);const t=this.messages,i=bi.getElement(),n=this.decorateOnTreeView;i&&"None"!==n&&this.applyDecorations(((e,t)=>{const i={},n=atom.project.getPaths();return t.forEach((t=>{const o=s(t);"string"==typeof o&&("Files"===e?[o]:((e,t)=>{const i=t.find((t=>e.startsWith(t)));return void 0===i?[e]:((e,t)=>{const i=[],s=e.split(je.sep);for(;s.length;){const e=s.join(je.sep);if(e&&(i.push(e),e===t))break;s.pop()}return i})(e,i)})(o,n)).forEach((e=>((e,t,i)=>{void 0===e[t]&&(e[t]={info:!1,error:!1,warning:!1}),e[t][i]=!0})(i,e,t.severity)))})),i})(n,t))}applyDecorations(e){const t=bi.getElement();if(!t)return;const i=new Map,s={},n=Object.keys(this.decorations);for(const s of n)if(!(s in e)){const e=p(i,s,(()=>bi.getElementByPath(t,s)));null!==e&&ke(e)}const o=Object.keys(e);for(const n of o){const o=p(i,n,(()=>bi.getElementByPath(t,n)));if(null!==o){const t=e[n];be(o,t,!!this.decorations[n]),s[n]=t}}this.decorations=s}dispose(){this.subscriptions.dispose()}static getElement(){return document.querySelector(".tree-view")}static getElementByPath(e,t){return e.querySelector(`[data-path=${CSS.escape(t)}]`)}}class ki{constructor(){this.name="Linter",this.signal=new St,this.commands=new xt,this.messages=[],this.statusBar=new Et,this.intentions=new Lt,this.subscriptions=new Ne,this.idleCallbacks=new Set,this.subscriptions.add(this.signal,this.commands,this.statusBar);const e=window.requestIdleCallback((async()=>{this.idleCallbacks.delete(e),this.panel=new Pt,await this.panel.update(this.messages)}));this.idleCallbacks.add(e);const t=window.requestIdleCallback((()=>{this.idleCallbacks.delete(t),this.subscriptions.add(atom.config.observe("linter-ui-default.showDecorations",(e=>{e&&!this.editors?(this.editors=new yi,this.editors.update({added:this.messages,removed:[],messages:this.messages})):!e&&this.editors&&(this.editors.dispose(),this.editors=null)})))}));this.idleCallbacks.add(t)}async render(e){const t=this.editors;this.messages=e.messages,t&&(t.isFirstRender()?t.update({added:e.messages,removed:[],messages:e.messages}):t.update(e)),this.treeview||(this.treeview=new bi,this.subscriptions.add(this.treeview)),this.treeview.update(e.messages),this.panel&&await this.panel.update(e.messages),this.commands.update(e.messages),this.intentions.update(e.messages),this.statusBar.update(e.messages)}didBeginLinting(e,t){this.signal.didBeginLinting(e,t)}didFinishLinting(e,t){this.signal.didFinishLinting(e,t)}dispose(){this.idleCallbacks.forEach((e=>window.cancelIdleCallback(e))),this.idleCallbacks.clear(),this.subscriptions.dispose(),this.panel&&this.panel.dispose(),this.editors&&this.editors.dispose()}}const Pi=new Set,xi=new Set;let Ci,Ei;
//# sourceMappingURL=index.js.map
