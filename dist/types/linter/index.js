"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));var _globalThis = function (Object) {function get() {var _global = this || self;delete Object.prototype.__magic__;return _global;}if (typeof globalThis === "object") {return globalThis;}if (this) {return get();} else {Object.defineProperty(Object.prototype, "__magic__", { configurable: true, get: get });var _global = __magic__;return _global;}}(Object);function _createForOfIteratorHelper(o, allowArrayLike) {var it;if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e11) {throw _e11;}, f: F };}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = o[Symbol.iterator]();}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e12) {didErr = true;err = _e12;}, f: function f() {try {if (!normalCompletion && it["return"] != null) it["return"]();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}Object.defineProperty(exports, "__esModule", { value: !0 });var e = require("atom"),t = "undefined" !== typeof _globalThis ? _globalThis : "undefined" !== typeof window ? window : "undefined" !== typeof global ? global : "undefined" !== typeof self ? self : {},i = "object" === (0, _typeof2["default"])(t) && t && t.Object === Object && t,s = "object" === (typeof self === "undefined" ? "undefined" : (0, _typeof2["default"])(self)) && self && self.Object === Object && self,r = i || s || Function("return this")(),n = r.Symbol,o = Object.prototype,a = o.hasOwnProperty,d = o.toString,l = n ? n.toStringTag : void 0;var c = function c(e) {var t = a.call(e, l),i = e[l];try {e[l] = void 0;var s = !0;} catch (e) {}var r = d.call(e);return s && (t ? e[l] = i : delete e[l]), r;},h = Object.prototype.toString;var u = function u(e) {return h.call(e);},g = n ? n.toStringTag : void 0;var p = function p(e) {return null == e ? void 0 === e ? "[object Undefined]" : "[object Null]" : g && g in Object(e) ? c(e) : u(e);};var f = function f(e) {var t = (0, _typeof2["default"])(e);return null != e && ("object" == t || "function" == t);};var m,v = function v(e) {if (!f(e)) {return !1;}var t = p(e);return "[object Function]" == t || "[object GeneratorFunction]" == t || "[object AsyncFunction]" == t || "[object Proxy]" == t;},b = r["__core-js_shared__"],y = (m = /[^.]+$/.exec(b && b.keys && b.keys.IE_PROTO || "")) ? "Symbol(src)_1.".concat(m) : "";var w = function w(e) {return Boolean(y) && y in e;},_ = Function.prototype.toString;var I = function I(e) {if (null != e) {try {return _.call(e);} catch (e) {}try {return "".concat(e);} catch (e) {}}return "";},L = /^\[object .+?Constructor]$/,E = Function.prototype,D = Object.prototype,$ = E.toString,P = D.hasOwnProperty,M = RegExp("^".concat($.call(P).replace(/[$()*+.?[\\\]^{|}]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\])/g, "$1.*?"), "$"));var C = function C(e) {return !(!f(e) || w(e)) && (v(e) ? M : L).test(I(e));};var j = function j(e, t) {return null == e ? void 0 : e[t];};var O = function O(e, t) {var i = j(e, t);return C(i) ? i : void 0;},A = O(Object, "create");var S = function S() {this.__data__ = A ? A(null) : {}, this.size = 0;};var U = function U(e) {var t = this.has(e) && delete this.__data__[e];return this.size -= t ? 1 : 0, t;},N = Object.prototype.hasOwnProperty;var T = function T(e) {var t = this.__data__;if (A) {var _i = t[e];return "__lodash_hash_undefined__" === _i ? void 0 : _i;}return N.call(t, e) ? t[e] : void 0;},k = Object.prototype.hasOwnProperty;var x = function x(e) {var t = this.__data__;return A ? void 0 !== t[e] : k.call(t, e);};var R = function R(e, t) {var i = this.__data__;return this.size += this.has(e) ? 0 : 1, i[e] = A && void 0 === t ? "__lodash_hash_undefined__" : t, this;};function F(e) {var t = -1,i = null == e ? 0 : e.length;for (this.clear(); ++t < i;) {var _s = e[t];this.set(_s[0], _s[1]);}}F.prototype.clear = S, F.prototype["delete"] = U, F.prototype.get = T, F.prototype.has = x, F.prototype.set = R;var B = F;var z = function z() {this.__data__ = [], this.size = 0;};var q = function q(e, t) {return e === t || e != e && t != t;};var V = function V(e, t) {for (var _i2 = e.length; _i2--;) {if (q(e[_i2][0], t)) {return _i2;}}return -1;},G = Array.prototype.splice;var K = function K(e) {var t = this.__data__,i = V(t, e);return !(i < 0) && (i == t.length - 1 ? t.pop() : G.call(t, i, 1), --this.size, !0);};var W = function W(e) {var t = this.__data__,i = V(t, e);return i < 0 ? void 0 : t[i][1];};var Y = function Y(e) {return V(this.__data__, e) > -1;};var X = function X(e, t) {var i = this.__data__,s = V(i, e);return s < 0 ? (++this.size, i.push([e, t])) : i[s][1] = t, this;};function H(e) {var t = -1,i = null == e ? 0 : e.length;for (this.clear(); ++t < i;) {var _s2 = e[t];this.set(_s2[0], _s2[1]);}}H.prototype.clear = z, H.prototype["delete"] = K, H.prototype.get = W, H.prototype.has = Y, H.prototype.set = X;var J = H,Q = O(r, "Map");var Z = function Z() {this.size = 0, this.__data__ = { hash: new B(), map: new (Q || J)(), string: new B() };};var ee = function ee(e) {var t = (0, _typeof2["default"])(e);return "string" == t || "number" == t || "symbol" == t || "boolean" == t ? "__proto__" !== e : null === e;};var te = function te(e, t) {var i = e.__data__;return ee(t) ? i["string" === typeof t ? "string" : "hash"] : i.map;};var ie = function ie(e) {var t = te(this, e)["delete"](e);return this.size -= t ? 1 : 0, t;};var se = function se(e) {return te(this, e).get(e);};var re = function re(e) {return te(this, e).has(e);};var ne = function ne(e, t) {var i = te(this, e),s = i.size;return i.set(e, t), this.size += i.size == s ? 0 : 1, this;};function oe(e) {var t = -1,i = null == e ? 0 : e.length;for (this.clear(); ++t < i;) {var _s3 = e[t];this.set(_s3[0], _s3[1]);}}oe.prototype.clear = Z, oe.prototype["delete"] = ie, oe.prototype.get = se, oe.prototype.has = re, oe.prototype.set = ne;var ae = oe;var de = function de(e) {return this.__data__.set(e, "__lodash_hash_undefined__"), this;};var le = function le(e) {return this.__data__.has(e);};function ce(e) {var t = -1,i = null == e ? 0 : e.length;for (this.__data__ = new ae(); ++t < i;) {this.add(e[t]);}}ce.prototype.add = ce.prototype.push = de, ce.prototype.has = le;var he = ce;var ue = function ue(e, t, i, s) {for (var _r = e.length, _n = i + (s ? 1 : -1); s ? _n-- : ++_n < _r;) {if (t(e[_n], _n, e)) {return _n;}}return -1;};var ge = function ge(e) {return e != e;};var pe = function pe(e, t, i) {for (var _s4 = i - 1, _r2 = e.length; ++_s4 < _r2;) {if (e[_s4] === t) {return _s4;}}return -1;};var fe = function fe(e, t, i) {return t == t ? pe(e, t, i) : ue(e, ge, i);};var me = function me(e, t) {return Boolean(null == e ? 0 : e.length) && fe(e, t, 0) > -1;};var ve = function ve(e, t, i) {for (var _s5 = -1, _r3 = null == e ? 0 : e.length; ++_s5 < _r3;) {if (i(t, e[_s5])) {return !0;}}return !1;};var be = function be(e, t) {return e.has(t);},ye = O(r, "Set");var we = function we() {};var _e = function _e(e) {var t = -1,i = Array(e.size);return e.forEach(function (e) {i[++t] = e;}), i;},Ie = ye && 1 / _e(new ye([, -0]))[1] == 1 / 0 ? function (e) {return new ye(e);} : we;var Le = function Le(e, t, i) {var s = -1,r = me,n = e.length,o = !0,a = [],d = a;if (i) {o = !1, r = ve;} else if (n >= 200) {var _l = t ? null : Ie(e);if (_l) {return _e(_l);}o = !1, r = be, d = new he();} else {d = t ? [] : a;}e: for (; ++s < n;) {var _c = e[s],_h = t ? t(_c) : _c;if (_c = i || 0 !== _c ? _c : 0, o && _h == _h) {for (var _u = d.length; _u--;) {if (d[_u] === _h) {continue e;}}t && d.push(_h), a.push(_c);} else {r(d, _h, i) || (d !== a && d.push(_h), a.push(_c));}}return a;};var Ee = function Ee(e) {return e && e.length ? Le(e) : [];};function De(e, t, i) {var s = i.map(function (e) {return "  \u2022 ".concat(e);});atom.notifications.addWarning("[Linter] ".concat(e), { dismissable: !0, detail: "".concat(t, "\n").concat(s.join("\n")) });}var $e = new Set(["error", "warning", "info"]);function Pe(t, i) {var s = [];if (Array.isArray(i)) {var _t = !1,_r4 = !1,_n2 = !1,_o = !1,_a = !1,_d = !1,_l2 = !1,_c2 = !1,_h2 = !1;for (var _u2 = 0, _g = i.length; _u2 < _g; ++_u2) {var _g2 = i[_u2],_p = _g2.reference;if (!_r4 && _g2.icon && "string" !== typeof _g2.icon && (_r4 = !0, s.push("Message.icon must be a string")), _o || _g2.location && "object" === (0, _typeof2["default"])(_g2.location) && "string" === typeof _g2.location.file && "object" === (0, _typeof2["default"])(_g2.location.position) && _g2.location.position) {if (!_o) {var _t2 = e.Range.fromObject(_g2.location.position);(Number.isNaN(_t2.start.row) || Number.isNaN(_t2.start.column) || Number.isNaN(_t2.end.row) || Number.isNaN(_t2.end.column)) && (_o = !0, s.push("Message.location.position should not contain NaN coordinates"));}} else {_o = !0, s.push("Message.location must be valid");}if (_d || !_g2.solutions || Array.isArray(_g2.solutions) || _g2.solutions instanceof Promise || (_d = !0, s.push("Message.solutions must be valid")), _l2 || !_p || "object" === (0, _typeof2["default"])(_p) && "string" === typeof _p.file && "object" === (0, _typeof2["default"])(_p.position) && _p.position) {if (!_l2 && _p && void 0 !== _p.position) {var _t3 = e.Point.fromObject(_p.position);(Number.isNaN(_t3.row) || Number.isNaN(_t3.column)) && (_l2 = !0, s.push("Message.reference.position should not contain NaN coordinates"));}} else {_l2 = !0, s.push("Message.reference must be valid");}_n2 || "string" === typeof _g2.excerpt || (_n2 = !0, s.push("Message.excerpt must be a string")), _a || $e.has(_g2.severity) || (_a = !0, s.push("Message.severity must be 'error', 'warning' or 'info'")), !_t && _g2.url && "string" !== typeof _g2.url && (_t = !0, s.push("Message.url must be a string")), !_c2 && _g2.description && "function" !== typeof _g2.description && "string" !== typeof _g2.description && (_c2 = !0, s.push("Message.description must be a function or string")), !_h2 && _g2.linterName && "string" !== typeof _g2.linterName && (_h2 = !0, s.push("Message.linterName must be a string"));}} else {s.push("Linter Result must be an Array");}return !s.length || (De("Invalid Linter Result received", "These issues were encountered while processing messages from a linter named '".concat(t, "'"), s), !1);}var Me = /*#__PURE__*/function () {function Me() {(0, _classCallCheck2["default"])(this, Me);this.providers = new Set(), this.subscriptions = new e.CompositeDisposable();}(0, _createClass2["default"])(Me, [{ key: "add", value: function add(e) {!this.providers.has(e) && function (e) {var t = [];return e && "object" === (0, _typeof2["default"])(e) ? ("string" !== typeof e.name && t.push("UI.name must be a string"), "function" !== typeof e.didBeginLinting && t.push("UI.didBeginLinting must be a function"), "function" !== typeof e.didFinishLinting && t.push("UI.didFinishLinting must be a function"), "function" !== typeof e.render && t.push("UI.render must be a function"), "function" !== typeof e.dispose && t.push("UI.dispose must be a function")) : t.push("UI must be an object"), !t.length || (De("Invalid UI received", "These issues were encountered while registering the UI named '".concat(e && e.name ? e.name : "Unknown", "'"), t), !1);}(e) && (this.subscriptions.add(e), this.providers.add(e));} }, { key: "delete", value: function _delete(e) {this.providers.has(e) && (e.dispose(), this.providers["delete"](e));} }, { key: "getProviders", value: function getProviders() {return Array.from(this.providers);} }, { key: "render", value: function render(e) {this.providers.forEach(function (t) {t.render(e);});} }, { key: "didBeginLinting", value: function didBeginLinting(e) {var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;this.providers.forEach(function (i) {i.didBeginLinting(e, t);});} }, { key: "didFinishLinting", value: function didFinishLinting(e) {var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;this.providers.forEach(function (i) {i.didFinishLinting(e, t);});} }, { key: "dispose", value: function dispose() {this.providers.clear(), this.subscriptions.dispose();} }]);return Me;}();var Ce = "__$sb_linter_activated",je = "__$sb_linter_request_last_received";function Oe(e, t, i) {return !(t && !e.lintsOnChange) && i.some(function (t) {return e.grammarScopes.includes(t);});}function Ae(e) {return Ee(e.getCursors().reduce(function (e, t) {return e.concat(t.getScopeDescriptor().getScopesArray());}, ["*"]));}var Se;function Ue(_x, _x2, _x3) {return _Ue.apply(this, arguments);}function _Ue() {_Ue = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee4(t, i, s) {var _i8, _s12, r;return _regenerator["default"].wrap(function _callee4$(_context4) {while (1) {switch (_context4.prev = _context4.next) {case 0:if (t) {_context4.next = 2;break;}return _context4.abrupt("return", !0);case 2:if (!s) {_context4.next = 9;break;}_i8 = new e.Directory(t);_context4.next = 6;return atom.project.repositoryForDirectory(_i8);case 6:_s12 = _context4.sent;if (!(_s12 && _s12.isPathIgnored(t))) {_context4.next = 9;break;}return _context4.abrupt("return", !0);case 9:r = "win32" === process.platform ? t.replace(/\\/g, "/") : t;return _context4.abrupt("return", (Se || (Se = require("minimatch")), Se(r, i)));case 11:case "end":return _context4.stop();}}}, _callee4);}));return _Ue.apply(this, arguments);}function Ne(e) {var t = e.reference,i = e.location;e.key = ["$LINTER:".concat(e.linterName), "$LOCATION:".concat(i.file, "$").concat(i.position.start.row, "$").concat(i.position.start.column, "$").concat(i.position.end.row, "$").concat(i.position.end.column), t ? "$REFERENCE:".concat(t.file, "$").concat(t.position ? "".concat(t.position.row, "$").concat(t.position.column) : "") : "$REFERENCE:null", "$EXCERPT:".concat(e.excerpt), "$SEVERITY:".concat(e.severity), e.icon ? "$ICON:".concat(e.icon) : "$ICON:null", e.url ? "$URL:".concat(e.url) : "$URL:null", "string" === typeof e.description ? "$DESCRIPTION:".concat(e.description) : "$DESCRIPTION:null"].join("");}function Te(e, t) {for (var _i3 = 0, _s6 = t.length; _i3 < _s6; ++_i3) {var _s7 = t[_i3],_r5 = _s7.reference,_n3 = _s7.solutions;if (_s7.location.position = xe(_s7.location.position), void 0 !== _r5 && void 0 !== _r5.position && (_r5.position = ke(_r5.position)), Array.isArray(_n3)) {for (var _e2 = 0, _t4 = _n3.length; _e2 < _t4; _e2++) {var _t5 = _n3[_e2];_t5.position = xe(_t5.position);}}_s7.version = 2, _s7.linterName || (_s7.linterName = e), Ne(_s7);}}function ke(t) {return t instanceof e.Point ? t : e.Point.fromObject(t);}function xe(t) {return t instanceof e.Range ? t : e.Range.fromObject(t);}function Re(e, t) {if (void 0 === e || void 0 === t) {return null;}if (!t.length) {return { oldKept: [], oldRemoved: [], newAdded: e };}if (!e.length) {return { oldKept: [], oldRemoved: t, newAdded: [] };}var i = function (e) {var t = new Map();for (var _i4 = 0, _s8 = e.length; _i4 < _s8; ++_i4) {var _s9 = e[_i4];t.set(_s9.key, _s9);}return t;}(t),s = new Set(),r = new Map();for (var _t6 = 0, _n4 = e.length; _t6 < _n4; _t6++) {var _n5 = e[_t6];i.has(_n5.key) ? r.set(_n5.key, _n5) : s.add(_n5);}var n = Array.from(i.keys()),o = Array.from(r.keys()),a = n.filter(function (e) {return !o.includes(e);}),d = new Set();for (var _e3 = 0, _t7 = a.length; _e3 < _t7; _e3++) {d.add(i.get(a[_e3]));}return { oldKept: Array.from(r.values()), oldRemoved: (0, _toConsumableArray2["default"])(d), newAdded: (0, _toConsumableArray2["default"])(s) };}function Fe(e, t) {t.length && Array.prototype.push.apply(e, t);}var Be = /*#__PURE__*/function () {function Be(t, i) {(0, _classCallCheck2["default"])(this, Be);this.scope = "project", this.emitter = new e.Emitter(), this.messages = new Map(), this.subscriptions = new e.CompositeDisposable(), this.indie = t, this.version = i, this.subscriptions.add(this.emitter);}(0, _createClass2["default"])(Be, [{ key: "name", get: function get() {return this.indie.name;} }, { key: "getMessages", value: function getMessages() {var e = [];return this.messages.forEach(function (t) {Fe(e, t);}), e;} }, { key: "clearMessages", value: function clearMessages() {this.subscriptions.disposed || (this.emitter.emit("did-update", []), this.messages.clear());} }, { key: "setMessages", value: function setMessages(e) {var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;if ("string" !== typeof e || !Array.isArray(t)) {throw new Error("Invalid Parameters to setMessages()");}!this.subscriptions.disposed && Pe(this.name, t) && (t.forEach(function (t) {if (t.location.file !== e) {throw console.debug("[Linter-UI-Default] Expected File", e, "Message", t), new Error("message.location.file does not match the given filePath");}}), Te(this.name, t), this.messages.set(e, t), this.emitter.emit("did-update", this.getMessages()));} }, { key: "setAllMessages", value: function setAllMessages(e) {if (!this.subscriptions.disposed && (Array.isArray(e) && !atom.inDevMode() || Pe(this.name, e))) {Te(this.name, e), this.messages.clear();for (var _t8 = 0, _i5 = e.length; _t8 < _i5; ++_t8) {var _i6 = e[_t8],_s10 = _i6.location.file;var _r6 = this.messages.get(_s10);_r6 || this.messages.set(_s10, _r6 = []), _r6.push(_i6);}this.emitter.emit("did-update", this.getMessages());}} }, { key: "onDidUpdate", value: function onDidUpdate(e) {return this.emitter.on("did-update", e);} }, { key: "onDidDestroy", value: function onDidDestroy(e) {return this.emitter.on("did-destroy", e);} }, { key: "dispose", value: function dispose() {this.emitter.emit("did-destroy"), this.subscriptions.dispose(), this.messages.clear();} }]);return Be;}();var ze = /*#__PURE__*/function () {function ze() {(0, _classCallCheck2["default"])(this, ze);this.emitter = new e.Emitter(), this.delegates = new Set(), this.subscriptions = new e.CompositeDisposable(), this.subscriptions.add(this.emitter);}(0, _createClass2["default"])(ze, [{ key: "register", value: function register(e, t) {var _this = this;if (!function (e) {var t = [];return e && "object" === (0, _typeof2["default"])(e) ? "string" !== typeof e.name && t.push("Indie.name must be a string") : t.push("Indie must be an object"), !t.length || (De("Invalid Indie received", "These issues were encountered while registering an Indie Linter named '".concat(e && e.name ? e.name : "Unknown", "'"), t), !1);}(e)) {throw new Error("Error registering Indie Linter");}var i = new Be(e, t);return this.delegates.add(i), i.onDidDestroy(function () {_this.delegates["delete"](i);}), i.onDidUpdate(function (e) {_this.emitter.emit("did-update", { linter: i, messages: e });}), this.emitter.emit("observe", i), i;} }, { key: "getProviders", value: function getProviders() {return Array.from(this.delegates);} }, { key: "observe", value: function observe(e) {return this.delegates.forEach(e), this.emitter.on("observe", e);} }, { key: "onDidUpdate", value: function onDidUpdate(e) {return this.emitter.on("did-update", e);} }, { key: "dispose", value: function dispose() {var _iterator = _createForOfIteratorHelper(this.delegates),_step;try {for (_iterator.s(); !(_step = _iterator.n()).done;) {var _e4 = _step.value;_e4.dispose();}} catch (err) {_iterator.e(err);} finally {_iterator.f();}this.subscriptions.dispose();} }]);return ze;}();var qe = function qe() {return r.Date.now();},Ve = /\s/;var Ge = function Ge(e) {for (var t = e.length; t-- && Ve.test(e.charAt(t));) {;}return t;},Ke = /^\s+/;var We = function We(e) {return e ? e.slice(0, Ge(e) + 1).replace(Ke, "") : e;};var Ye = function Ye(e) {return null != e && "object" === (0, _typeof2["default"])(e);};var Xe = function Xe(e) {return "symbol" === (0, _typeof2["default"])(e) || Ye(e) && "[object Symbol]" == p(e);},He = /^[+-]0x[\da-f]+$/i,Je = /^0b[01]+$/i,Qe = /^0o[0-7]+$/i,Ze = parseInt;var et = function et(e) {if ("number" === typeof e) {return e;}if (Xe(e)) {return NaN;}if (f(e)) {var _t9 = "function" === typeof e.valueOf ? e.valueOf() : e;e = f(_t9) ? "".concat(_t9) : _t9;}if ("string" !== typeof e) {return 0 === e ? e : Number(e);}e = We(e);var i = Je.test(e);return i || Qe.test(e) ? Ze(e.slice(2), i ? 2 : 8) : He.test(e) ? NaN : Number(e);},tt = Math.max,it = Math.min;var st = function st(e, t, i) {var s,r,n,o,a,d,l = 0,c = !1,h = !1,u = !0;if ("function" !== typeof e) {throw new TypeError("Expected a function");}function g(t) {var i = s,n = r;return s = r = void 0, l = t, o = e.apply(n, i);}function p(e) {return l = e, a = setTimeout(v, t), c ? g(e) : o;}function m(e) {var i = e - d;return void 0 === d || i >= t || i < 0 || h && e - l >= n;}function v() {var e = qe();if (m(e)) {return b(e);}a = setTimeout(v, function (e) {var i = t - (e - d);return h ? it(i, n - (e - l)) : i;}(e));}function b(e) {return a = void 0, u && s ? g(e) : (s = r = void 0, o);}function y() {var e = qe(),i = m(e);if (s = arguments, r = this, d = e, i) {if (void 0 === a) {return p(d);}if (h) {return clearTimeout(a), a = setTimeout(v, t), g(d);}}return void 0 === a && (a = setTimeout(v, t)), o;}return t = et(t) || 0, f(i) && (c = Boolean(i.leading), n = (h = "maxWait" in i) ? tt(et(i.maxWait) || 0, t) : n, u = "trailing" in i ? Boolean(i.trailing) : u), y.cancel = function () {void 0 !== a && clearTimeout(a), l = 0, s = d = r = a = void 0;}, y.flush = function () {return void 0 === a ? o : b(qe());}, y;};var rt = /*#__PURE__*/function () {function rt() {(0, _classCallCheck2["default"])(this, rt);this.emitter = new e.Emitter(), this.messages = [], this.messagesMap = new Set(), this.subscriptions = new e.CompositeDisposable(), this.debouncedUpdate = st(this.update, 100, { leading: !0 }), this.subscriptions.add(this.emitter);}(0, _createClass2["default"])(rt, [{ key: "set", value: function set(_ref) {var e = _ref.messages,t = _ref.linter,i = _ref.buffer;var s = null;var _iterator2 = _createForOfIteratorHelper(this.messagesMap),_step2;try {for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {var _e5 = _step2.value;if (_e5.buffer === i && _e5.linter === t) {s = _e5;break;}}} catch (err) {_iterator2.e(err);} finally {_iterator2.f();}s ? (s.messages = e, s.changed = !0) : this.messagesMap.add({ messages: e, linter: t, buffer: i, oldMessages: [], changed: !0, deleted: !1 }), this.debouncedUpdate();} }, { key: "update", value: function update() {var e = { added: [], removed: [], messages: [] };var _iterator3 = _createForOfIteratorHelper(this.messagesMap),_step3;try {for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {var _t10 = _step3.value;if (_t10.deleted) {Fe(e.removed, _t10.oldMessages), this.messagesMap["delete"](_t10);continue;}if (!_t10.changed) {Fe(e.messages, _t10.oldMessages);continue;}var _i7 = Re(_t10.messages, _t10.oldMessages);if (null !== _i7) {var _s11 = _i7.oldKept,_r7 = _i7.oldRemoved,_n6 = _i7.newAdded;Fe(e.added, _n6), Fe(e.removed, _r7);var _o2 = _n6.concat(_s11);Fe(e.messages, _o2), _t10.oldMessages = _o2;}}} catch (err) {_iterator3.e(err);} finally {_iterator3.f();}(e.added.length || e.removed.length) && (this.messages = e.messages, this.emitter.emit("did-update-messages", e));} }, { key: "onDidUpdateMessages", value: function onDidUpdateMessages(e) {return this.emitter.on("did-update-messages", e);} }, { key: "deleteByBuffer", value: function deleteByBuffer(e) {var _iterator4 = _createForOfIteratorHelper(this.messagesMap),_step4;try {for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {var _t11 = _step4.value;_t11.buffer === e && (_t11.deleted = !0);}} catch (err) {_iterator4.e(err);} finally {_iterator4.f();}this.debouncedUpdate();} }, { key: "deleteByLinter", value: function deleteByLinter(e) {var _iterator5 = _createForOfIteratorHelper(this.messagesMap),_step5;try {for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {var _t12 = _step5.value;_t12.linter === e && (_t12.deleted = !0);}} catch (err) {_iterator5.e(err);} finally {_iterator5.f();}this.debouncedUpdate();} }, { key: "dispose", value: function dispose() {this.subscriptions.dispose();} }]);return rt;}();var nt = /*#__PURE__*/function () {function nt() {var _this2 = this;(0, _classCallCheck2["default"])(this, nt);this.emitter = new e.Emitter(), this.linters = new Set(), this.lintOnChange = !0, this.ignoreVCS = !0, this.ignoreGlob = "**/*.min.{js,css}", this.lintPreviewTabs = !0, this.subscriptions = new e.CompositeDisposable(), this.disabledProviders = [], this.activeNotifications = new Set(), this.subscriptions.add(this.emitter, atom.config.observe("linter.lintOnChange", function (e) {_this2.lintOnChange = e;}), atom.config.observe("core.excludeVcsIgnoredPaths", function (e) {_this2.ignoreVCS = e;}), atom.config.observe("linter.ignoreGlob", function (e) {_this2.ignoreGlob = e;}), atom.config.observe("linter.lintPreviewTabs", function (e) {_this2.lintPreviewTabs = e;}), atom.config.observe("linter.disabledProviders", function (e) {_this2.disabledProviders = e;}));}(0, _createClass2["default"])(nt, [{ key: "hasLinter", value: function hasLinter(e) {return this.linters.has(e);} }, { key: "addLinter", value: function addLinter(e) {(function (e) {var t = [];return e && "object" === (0, _typeof2["default"])(e) ? ("string" !== typeof e.name && t.push("Linter.name must be a string"), ("string" !== typeof e.scope || "file" !== e.scope && "project" !== e.scope) && t.push("Linter.scope must be either 'file' or 'project'"), "boolean" !== typeof e.lintsOnChange && t.push("Linter.lintsOnChange must be a boolean"), Array.isArray(e.grammarScopes) || t.push("Linter.grammarScopes must be an Array"), "function" !== typeof e.lint && t.push("Linter.lint must be a function")) : t.push("Linter must be an object"), !t.length || (De("Invalid Linter received", "These issues were encountered while registering a Linter named '".concat(e && e.name ? e.name : "Unknown", "'"), t), !1);})(e) && (e[Ce] = !0, void 0 === e.__$sb_linter_request_latest && (e.__$sb_linter_request_latest = 0), void 0 === e[je] && (e[je] = 0), e.__$sb_linter_version = 2, this.linters.add(e));} }, { key: "getProviders", value: function getProviders() {return Array.from(this.linters);} }, { key: "deleteLinter", value: function deleteLinter(e) {this.linters.has(e) && (e[Ce] = !1, this.linters["delete"](e));} }, { key: "lint", value: function () {var _lint = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(_ref2) {var _this3 = this;var e, t, i, s, r, _iterator6, _step6, _loop, _ret;return _regenerator["default"].wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:e = _ref2.onChange, t = _ref2.editor;i = t.getPath();_context.t0 = e && !this.lintOnChange || !this.lintPreviewTabs && atom.workspace.getActivePane().getPendingItem() === t;if (_context.t0) {_context.next = 7;break;}_context.next = 6;return Ue(t.getPath(), this.ignoreGlob, this.ignoreVCS);case 6:_context.t0 = _context.sent;case 7:if (!_context.t0) {_context.next = 9;break;}return _context.abrupt("return", !1);case 9:s = Ae(t), r = [];_iterator6 = _createForOfIteratorHelper(this.linters);_context.prev = 11;_loop = function _loop() {var n = _step6.value;if (!Oe(n, e, s)) {return "continue";}if (_this3.disabledProviders.includes(n.name)) {return "continue";}var o = ++n.__$sb_linter_request_latest,a = "file" === n.scope ? t.getBuffer() : null,d = "file" === n.scope ? i : null;_this3.emitter.emit("did-begin-linting", { number: o, linter: n, filePath: d }), r.push(new Promise(function (e) {e(n.lint(t));}).then(function (e) {if (_this3.emitter.emit("did-finish-linting", { number: o, linter: n, filePath: d }), n[je] >= o || !n[Ce] || a && !a.isAlive()) {return;}if (n[je] = o, a && !a.isAlive()) {return;}if (null === e) {return;}var t = !0;!atom.inDevMode() && Array.isArray(e) || (t = Pe(n.name, e)), t && (Te(n.name, e), _this3.emitter.emit("did-update-messages", { messages: e, linter: n, buffer: a }));}, function (e) {_this3.emitter.emit("did-finish-linting", { number: o, linter: n, filePath: d }), console.error("[Linter] Error running ".concat(n.name), e);var t = "[Linter] Error running ".concat(n.name);if (Array.from(_this3.activeNotifications).some(function (e) {return e.getOptions().detail === t;})) {return;}var i = atom.notifications.addError(t, { detail: "See Console for more info.", dismissable: !0, buttons: [{ text: "Open Console", onDidClick: function onDidClick() {atom.openDevTools(), i.dismiss();} }, { text: "Cancel", onDidClick: function onDidClick() {i.dismiss();} }] });}));};_iterator6.s();case 14:if ((_step6 = _iterator6.n()).done) {_context.next = 20;break;}_ret = _loop();if (!(_ret === "continue")) {_context.next = 18;break;}return _context.abrupt("continue", 18);case 18:_context.next = 14;break;case 20:_context.next = 25;break;case 22:_context.prev = 22;_context.t1 = _context["catch"](11);_iterator6.e(_context.t1);case 25:_context.prev = 25;_iterator6.f();return _context.finish(25);case 28:_context.next = 30;return Promise.all(r);case 30:return _context.abrupt("return", !0);case 31:case "end":return _context.stop();}}}, _callee, this, [[11, 22, 25, 28]]);}));function lint(_x4) {return _lint.apply(this, arguments);}return lint;}() }, { key: "onDidUpdateMessages", value: function onDidUpdateMessages(e) {return this.emitter.on("did-update-messages", e);} }, { key: "onDidBeginLinting", value: function onDidBeginLinting(e) {return this.emitter.on("did-begin-linting", e);} }, { key: "onDidFinishLinting", value: function onDidFinishLinting(e) {return this.emitter.on("did-finish-linting", e);} }, { key: "dispose", value: function dispose() {this.activeNotifications.forEach(function (e) {return e.dismiss();}), this.activeNotifications.clear(), this.linters.clear(), this.subscriptions.dispose();} }]);return nt;}();var ot = /*#__PURE__*/function () {function ot(t) {var _this4 = this;(0, _classCallCheck2["default"])(this, ot);if (this.emitter = new e.Emitter(), this.subscriptions = new e.CompositeDisposable(), !atom.workspace.isTextEditor(t)) {throw new Error("EditorLinter expects a valid TextEditor");}var i = t.getBuffer(),s = st(function () {_this4.emitter.emit("should-lint", !1);}, 50, { leading: !0 });this.editor = t, this.subscriptions.add(this.editor.onDidDestroy(function () {return _this4.dispose();}), this.editor.onDidSave(s), i.onDidReload(s), this.subscriptiveObserve(atom.config, "linter.lintOnChangeInterval", function (e) {return i.onDidChange(st(function () {_this4.emitter.emit("should-lint", !0);}, e));}));}(0, _createClass2["default"])(ot, [{ key: "getEditor", value: function getEditor() {return this.editor;} }, { key: "lint", value: function lint() {var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !1;this.emitter.emit("should-lint", e);} }, { key: "onShouldLint", value: function onShouldLint(e) {return this.emitter.on("should-lint", e);} }, { key: "onDidDestroy", value: function onDidDestroy(e) {return this.emitter.on("did-destroy", e);} }, { key: "dispose", value: function dispose() {this.emitter.emit("did-destroy"), this.subscriptions.dispose(), this.emitter.dispose();} }, { key: "subscriptiveObserve", value: function subscriptiveObserve(t, i, s) {var _this5 = this;var r = null;var n = t.observe(i, function (e) {r && r.dispose(), r = s.call(_this5, e);});return new e.Disposable(function () {n.dispose(), r && r.dispose();});} }]);return ot;}();var at = /*#__PURE__*/function () {function at() {var _this6 = this;(0, _classCallCheck2["default"])(this, at);this.emitter = new e.Emitter(), this.lintOnOpen = !0, this.subscriptions = new e.CompositeDisposable(), this.editorLinters = new Map(), this.subscriptions.add(this.emitter, atom.config.observe("linter.lintOnOpen", function (e) {_this6.lintOnOpen = e;}));}(0, _createClass2["default"])(at, [{ key: "activate", value: function activate() {var _this7 = this;this.subscriptions.add(atom.workspace.observeTextEditors(function (e) {_this7.createFromTextEditor(e);}));} }, { key: "get", value: function get(e) {return this.editorLinters.get(e);} }, { key: "createFromTextEditor", value: function createFromTextEditor(e) {var _this8 = this;var t = this.editorLinters.get(e);return t || (t = new ot(e), t.onDidDestroy(function () {_this8.editorLinters["delete"](e);}), this.editorLinters.set(e, t), this.emitter.emit("observe", t), this.lintOnOpen && t.lint(), t);} }, { key: "hasSibling", value: function hasSibling(e) {var t = e.getEditor().getBuffer();return Array.from(this.editorLinters.keys()).some(function (e) {return e.getBuffer() === t;});} }, { key: "observe", value: function observe(e) {return this.editorLinters.forEach(e), this.emitter.on("observe", e);} }, { key: "dispose", value: function dispose() {var _iterator7 = _createForOfIteratorHelper(this.editorLinters.values()),_step7;try {for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {var _e6 = _step7.value;_e6.dispose();}} catch (err) {_iterator7.e(err);} finally {_iterator7.f();}this.subscriptions.dispose();} }]);return at;}();var dt, lt, ct, ht;function ut(e) {var t;if (e && "object" === (0, _typeof2["default"])(e) && "string" === typeof e.name) {t = e.name;} else {if ("string" !== typeof e) {throw new Error("Unknown object passed to formatItem()");}t = e;}return "  - ".concat(t);}function gt(e, t) {return e.name.localeCompare(t.name);}var pt = /*#__PURE__*/function () {function pt() {var _this9 = this;(0, _classCallCheck2["default"])(this, pt);this.emitter = new e.Emitter(), this.subscriptions = new e.CompositeDisposable(), this.subscriptions.add(this.emitter, atom.commands.add("atom-workspace", { "linter:enable-linter": function linterEnableLinter() {return _this9.enableLinter();}, "linter:disable-linter": function linterDisableLinter() {return _this9.disableLinter();} }), atom.commands.add("atom-text-editor:not([mini])", { "linter:lint": function linterLint() {return _this9.lint();}, "linter:debug": function linterDebug() {return _this9.debug();}, "linter:toggle-active-editor": function linterToggleActiveEditor() {return _this9.toggleActiveEditor();} }));}(0, _createClass2["default"])(pt, [{ key: "lint", value: function lint() {this.emitter.emit("should-lint");} }, { key: "debug", value: function debug() {this.emitter.emit("should-debug");} }, { key: "enableLinter", value: function enableLinter() {this.emitter.emit("should-toggle-linter", "enable");} }, { key: "disableLinter", value: function disableLinter() {this.emitter.emit("should-toggle-linter", "disable");} }, { key: "toggleActiveEditor", value: function toggleActiveEditor() {this.emitter.emit("should-toggle-active-editor");} }, { key: "onShouldLint", value: function onShouldLint(e) {return this.emitter.on("should-lint", e);} }, { key: "onShouldDebug", value: function onShouldDebug(e) {return this.emitter.on("should-debug", e);} }, { key: "onShouldToggleActiveEditor", value: function onShouldToggleActiveEditor(e) {return this.emitter.on("should-toggle-active-editor", e);} }, { key: "onShouldToggleLinter", value: function onShouldToggleLinter(e) {return this.emitter.on("should-toggle-linter", e);} }, { key: "dispose", value: function dispose() {this.subscriptions.dispose();} }]);return pt;}();var ft = /*#__PURE__*/function () {function ft(t, i) {var _this10 = this;(0, _classCallCheck2["default"])(this, ft);this.emitter = new e.Emitter(), this.subscriptions = new e.CompositeDisposable(), this.disabledProviders = [], this.action = t, this.providers = i, this.subscriptions.add(this.emitter, atom.config.observe("linter.disabledProviders", function (e) {_this10.disabledProviders = e;}));}(0, _createClass2["default"])(ft, [{ key: "getItems", value: function getItems() {var _this11 = this;return "disable" === this.action ? this.providers.filter(function (e) {return !_this11.disabledProviders.includes(e);}) : this.disabledProviders;} }, { key: "process", value: function process(e) {if ("disable" === this.action) {this.disabledProviders.push(e), this.emitter.emit("did-disable", e);} else {var _t13 = this.disabledProviders.indexOf(e);-1 !== _t13 && this.disabledProviders.splice(_t13, 1);}atom.config.set("linter.disabledProviders", this.disabledProviders);} }, { key: "show", value: function show() {var _this12 = this;lt || (lt = require("atom-select-list"));var t = new lt({ items: this.getItems(), emptyMessage: "No matches found", elementForItem: function elementForItem(e) {var t = document.createElement("li");return t.textContent = e, t;}, didConfirmSelection: function didConfirmSelection(e) {try {_this12.process(e), _this12.dispose();} catch (e) {console.error("[Linter] Unable to process toggle:", e);}}, didCancelSelection: function didCancelSelection() {_this12.dispose();}, didConfirmEmptySelection: function didConfirmEmptySelection() {_this12.dispose();} }),i = atom.workspace.addModalPanel({ item: t });t.focus(), this.subscriptions.add(new e.Disposable(function () {i.destroy();}));} }, { key: "onDidDispose", value: function onDidDispose(e) {return this.emitter.on("did-dispose", e);} }, { key: "onDidDisable", value: function onDidDisable(e) {return this.emitter.on("did-disable", e);} }, { key: "dispose", value: function dispose() {this.emitter.emit("did-dispose"), this.subscriptions.dispose();} }]);return ft;}();var mt = /*#__PURE__*/function () {function mt() {var _this13 = this;(0, _classCallCheck2["default"])(this, mt);this.commands = new pt(), this.subscriptions = new e.CompositeDisposable(), this.idleCallbacks = new Set(), this.subscriptions.add(this.commands), this.commands.onShouldLint(function () {_this13.registryEditorsInit();var e = atom.workspace.getActiveTextEditor();if (void 0 === e) {return;}var t = _this13.registryEditors.get(e);t && t.lint();}), this.commands.onShouldToggleActiveEditor(function () {var e = atom.workspace.getActiveTextEditor();if (void 0 === e) {return;}_this13.registryEditorsInit();var t = _this13.registryEditors.get(e);t ? t.dispose() : e && _this13.registryEditors.createFromTextEditor(e);}), this.commands.onShouldDebug( /*#__PURE__*/(0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee3() {return _regenerator["default"].wrap(function _callee3$(_context3) {while (1) {switch (_context3.prev = _context3.next) {case 0:_this13.registryUIInit();_this13.registryIndieInit();_this13.registryLintersInit();_context3.next = 5;return function () {var _ref4 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee2(e, t, i) {var s, r, n, o, a, d, l, c, h, u, g, p, f, m;return _regenerator["default"].wrap(function _callee2$(_context2) {while (1) {switch (_context2.prev = _context2.next) {case 0:dt || (dt = require("../package.json"));s = atom.workspace.getActiveTextEditor();if (!(void 0 === s)) {_context2.next = 4;break;}return _context2.abrupt("return");case 4:r = Ae(s);n = e.slice().sort(gt);o = t.slice().sort(gt);a = i.slice().sort(gt);d = o.map(ut).join("\n");l = n.map(ut).join("\n");c = n.filter(function (e) {return Oe(e, !1, r);}).map(ut).join("\n");h = r.map(ut).join("\n");u = a.map(ut).join("\n");g = atom.config.get("linter.ignoreGlob");p = atom.config.get("core.excludeVcsIgnoredPaths");f = atom.config.get("linter.disabledProviders").map(ut).join("\n");_context2.next = 18;return Ue(s.getPath(), g, p);case 18:m = _context2.sent;atom.notifications.addInfo("Linter Debug Info", { detail: ["Platform: ".concat(process.platform), "Atom Version: ".concat(atom.getVersion()), "Linter Version: ".concat(dt.version), "Opened file is ignored: ".concat(m ? "Yes" : "No"), "Matching Linter Providers: \n".concat(c), "Disabled Linter Providers: \n".concat(f), "Standard Linter Providers: \n".concat(l), "Indie Linter Providers: \n".concat(d), "UI Providers: \n".concat(u), "Ignore Glob: ".concat(g), "VCS Ignored Paths are excluded: ".concat(p), "Current File Scopes: \n".concat(h)].join("\n"), dismissable: !0 });case 20:case "end":return _context2.stop();}}}, _callee2);}));return function (_x5, _x6, _x7) {return _ref4.apply(this, arguments);};}()(_this13.registryLinters.getProviders(), _this13.registryIndie.getProviders(), _this13.registryUI.getProviders());case 5:case "end":return _context3.stop();}}}, _callee3);}))), this.commands.onShouldToggleLinter(function (e) {_this13.registryLintersInit();var t = new ft(e, Ee(_this13.registryLinters.getProviders().map(function (e) {return e.name;})));t.onDidDispose(function () {_this13.subscriptions.remove(t);}), t.onDidDisable(function (e) {var t = _this13.registryLinters.getProviders().find(function (t) {return t.name === e;});t && (_this13.registryMessagesInit(), _this13.registryMessages.deleteByLinter(t));}), t.show(), _this13.subscriptions.add(t);});var t = window.requestIdleCallback(function () {_this13.idleCallbacks["delete"](t), _this13.subscriptions.add(atom.project.onDidChangePaths(function () {_this13.commands.lint();}));});this.idleCallbacks.add(t);var i = window.requestIdleCallback(function () {_this13.idleCallbacks["delete"](i), _this13.registryEditorsInit();});this.idleCallbacks.add(i);}(0, _createClass2["default"])(mt, [{ key: "dispose", value: function dispose() {this.idleCallbacks.forEach(function (e) {return window.cancelIdleCallback(e);}), this.idleCallbacks.clear(), this.subscriptions.dispose();} }, { key: "registryEditorsInit", value: function registryEditorsInit() {var _this14 = this;void 0 === this.registryEditors && (this.registryEditors = new at(), this.subscriptions.add(this.registryEditors), this.registryEditors.observe(function (e) {e.onShouldLint(function (t) {_this14.registryLintersInit(), _this14.registryLinters.lint({ onChange: t, editor: e.getEditor() });}), e.onDidDestroy(function () {_this14.registryMessagesInit(), _this14.registryEditors.hasSibling(e) || _this14.registryMessages.deleteByBuffer(e.getEditor().getBuffer());});}), this.registryEditors.activate());} }, { key: "registryLintersInit", value: function registryLintersInit() {var _this15 = this;void 0 === this.registryLinters && (this.registryLinters = new nt(), this.subscriptions.add(this.registryLinters), this.registryLinters.onDidUpdateMessages(function (_ref5) {var e = _ref5.linter,t = _ref5.messages,i = _ref5.buffer;_this15.registryMessagesInit(), _this15.registryMessages.set({ linter: e, messages: t, buffer: i });}), this.registryLinters.onDidBeginLinting(function (_ref6) {var e = _ref6.linter,t = _ref6.filePath;_this15.registryUIInit(), _this15.registryUI.didBeginLinting(e, t);}), this.registryLinters.onDidFinishLinting(function (_ref7) {var e = _ref7.linter,t = _ref7.filePath;_this15.registryUIInit(), _this15.registryUI.didFinishLinting(e, t);}));} }, { key: "registryIndieInit", value: function registryIndieInit() {var _this16 = this;void 0 === this.registryIndie && (this.registryIndie = new ze(), this.subscriptions.add(this.registryIndie), this.registryIndie.observe(function (e) {e.onDidDestroy(function () {_this16.registryMessagesInit(), _this16.registryMessages.deleteByLinter(e);});}), this.registryIndie.onDidUpdate(function (_ref8) {var e = _ref8.linter,t = _ref8.messages;_this16.registryMessagesInit(), _this16.registryMessages.set({ linter: e, messages: t, buffer: null });}));} }, { key: "registryMessagesInit", value: function registryMessagesInit() {var _this17 = this;this.registryMessages || (this.registryMessages = new rt(), this.subscriptions.add(this.registryMessages), this.registryMessages.onDidUpdateMessages(function (e) {_this17.registryUIInit(), _this17.registryUI.render(e);}));} }, { key: "registryUIInit", value: function registryUIInit() {void 0 === this.registryUI && (this.registryUI = new Me(), this.subscriptions.add(this.registryUI));} }, { key: "addUI", value: function addUI(e) {this.registryUIInit(), this.registryUI.add(e), this.registryMessagesInit();var t = this.registryMessages.messages;t.length && e.render({ added: t, messages: t, removed: [] });} }, { key: "deleteUI", value: function deleteUI(e) {this.registryUIInit(), this.registryUI["delete"](e);} }, { key: "addLinter", value: function addLinter(e) {this.registryLintersInit(), this.registryLinters.addLinter(e);} }, { key: "deleteLinter", value: function deleteLinter(e) {this.registryLintersInit(), this.registryLinters.deleteLinter(e), this.registryMessagesInit(), this.registryMessages.deleteByLinter(e);} }, { key: "addIndie", value: function addIndie(e) {return this.registryIndieInit(), this.registryIndie.register(e, 2);} }]);return mt;}();exports.activate = function () {ht = new e.CompositeDisposable(), ct = new mt(), ht.add(ct, atom.packages.onDidActivateInitialPackages(function () {atom.inSpecMode() || require("atom-package-deps").install("linter", !0);}));}, exports.consumeLinter = function (t) {var i = Array.isArray(t) ? t : [t];var _iterator8 = _createForOfIteratorHelper(i),_step8;try {for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {var _e8 = _step8.value;ct.addLinter(_e8);}} catch (err) {_iterator8.e(err);} finally {_iterator8.f();}return new e.Disposable(function () {var _iterator9 = _createForOfIteratorHelper(i),_step9;try {for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {var _e7 = _step9.value;ct.deleteLinter(_e7);}} catch (err) {_iterator9.e(err);} finally {_iterator9.f();}});}, exports.consumeUI = function (t) {var i = Array.isArray(t) ? t : [t];var _iterator10 = _createForOfIteratorHelper(i),_step10;try {for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {var _e10 = _step10.value;ct.addUI(_e10);}} catch (err) {_iterator10.e(err);} finally {_iterator10.f();}return new e.Disposable(function () {var _iterator11 = _createForOfIteratorHelper(i),_step11;try {for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {var _e9 = _step11.value;ct.deleteUI(_e9);}} catch (err) {_iterator11.e(err);} finally {_iterator11.f();}});}, exports.deactivate = function () {ht.dispose();}, exports.provideIndie = function () {return function (e) {return ct.addIndie(e);};};